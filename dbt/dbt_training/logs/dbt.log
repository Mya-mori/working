

============================== 2022-05-17 15:19:43.316092 | b919beae-fa1c-482f-8fad-718c7e6c841a ==============================
15:19:43.316100 [info ] [MainThread]: Running with dbt=1.1.0
15:19:43.316566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
15:19:43.316742 [debug] [MainThread]: Tracking: tracking
15:19:43.336669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93099d02d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9308c77650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93099d0ed0>]}
15:19:43.338613 [info ] [MainThread]: Creating dbt configuration folder at /Users/haratodaisuke/.dbt
15:19:43.339359 [info ] [MainThread]: Setting up your profile.
15:20:05.136079 [info ] [MainThread]: Profile dbt_training_dw written to /Users/haratodaisuke/.dbt/profiles.yml using target's sample configuration. Once updated, you'll be able to start developing with dbt.
15:20:05.136593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9307039ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9309b06b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9309b06f50>]}


============================== 2022-05-17 15:29:09.694792 | 9d976ba9-143b-43b1-aff4-5e147b94edbb ==============================
15:29:09.694844 [info ] [MainThread]: Running with dbt=1.1.0
15:29:09.696184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:29:09.696443 [debug] [MainThread]: Tracking: tracking
15:29:09.717502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3c04e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c39c1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3c04050>]}
15:29:09.736866 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
15:29:09.737280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d976ba9-143b-43b1-aff4-5e147b94edbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3c02450>]}
15:29:09.761406 [debug] [MainThread]: Parsing macros/catalog.sql
15:29:09.767068 [debug] [MainThread]: Parsing macros/relations.sql
15:29:09.769194 [debug] [MainThread]: Parsing macros/adapters.sql
15:29:09.798293 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
15:29:09.800649 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:29:09.805766 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:29:09.808907 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:29:09.811046 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:29:09.833515 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:29:09.849435 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:29:09.864005 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:29:09.870153 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:29:09.872558 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:29:09.875107 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:29:09.881060 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:29:09.901880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:29:09.903929 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:29:09.918022 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:29:09.937190 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:29:09.946649 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:29:09.950557 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:29:09.959840 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:29:09.961664 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:29:09.965239 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:29:09.968474 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:29:09.976869 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:29:09.997512 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:29:09.999454 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:29:10.002799 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:29:10.004848 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:29:10.005971 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:29:10.007202 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:29:10.008214 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:29:10.010675 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:29:10.017023 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:29:10.028285 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:29:10.031221 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:29:10.035073 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:29:10.078570 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:29:10.083180 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:29:10.090090 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:29:10.100106 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:29:10.113741 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:29:10.385923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

15:29:10.392543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d976ba9-143b-43b1-aff4-5e147b94edbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c2087210>]}
15:29:10.398368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d976ba9-143b-43b1-aff4-5e147b94edbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3cd4210>]}
15:29:10.398753 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:29:10.399112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d976ba9-143b-43b1-aff4-5e147b94edbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3cd4b10>]}
15:29:10.400127 [info ] [MainThread]:
15:29:10.400467 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
15:29:10.405981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c39f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3cf1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3cf1110>]}ÃŸÃŸ

============================== 2022-05-19 06:50:21.405077 | a3e34e64-d602-46b8-8e7b-2f4e0745aa37 ==============================
06:50:21.405123 [info ] [MainThread]: Running with dbt=1.1.0
06:50:21.406452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:50:21.406745 [debug] [MainThread]: Tracking: tracking
06:50:21.437249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24c0ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24a56950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24a56910>]}
06:50:21.512554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:50:21.513160 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models/materialized_dwh/employee_names.sql
06:50:21.562915 [debug] [MainThread]: 1699: static parser successfully parsed materialized_dwh/employee_names.sql
06:50:21.592097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3e34e64-d602-46b8-8e7b-2f4e0745aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24493390>]}
06:50:21.597716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3e34e64-d602-46b8-8e7b-2f4e0745aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24c65d90>]}
06:50:21.598104 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
06:50:21.598544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3e34e64-d602-46b8-8e7b-2f4e0745aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24c65b50>]}
06:50:21.599882 [info ] [MainThread]: 
06:50:21.600532 [debug] [MainThread]: Acquiring new postgres connection "master"
06:50:21.601557 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
06:50:21.616120 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
06:50:21.616418 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
06:50:21.616625 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:50:21.729500 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.11 seconds
06:50:21.731123 [debug] [ThreadPool]: On list_dbt_training: Close
06:50:21.732217 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
06:50:21.740417 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
06:50:21.740677 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
06:50:21.740877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:50:21.755060 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
06:50:21.755782 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
06:50:21.756004 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
06:50:21.761693 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
06:50:21.763139 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
06:50:21.763498 [debug] [ThreadPool]: On list_dbt_training_public: Close
06:50:21.768608 [debug] [MainThread]: Using postgres connection "master"
06:50:21.768879 [debug] [MainThread]: On master: BEGIN
06:50:21.769063 [debug] [MainThread]: Opening a new connection, currently in state init
06:50:21.778331 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
06:50:21.778602 [debug] [MainThread]: Using postgres connection "master"
06:50:21.778790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
06:50:22.069362 [debug] [MainThread]: SQL status: SELECT 0 in 0.29 seconds
06:50:22.070915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3e34e64-d602-46b8-8e7b-2f4e0745aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24c56510>]}
06:50:22.071314 [debug] [MainThread]: On master: ROLLBACK
06:50:22.071722 [debug] [MainThread]: Using postgres connection "master"
06:50:22.071962 [debug] [MainThread]: On master: BEGIN
06:50:22.072458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
06:50:22.072711 [debug] [MainThread]: On master: COMMIT
06:50:22.072935 [debug] [MainThread]: Using postgres connection "master"
06:50:22.073260 [debug] [MainThread]: On master: COMMIT
06:50:22.073744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
06:50:22.074003 [debug] [MainThread]: On master: Close
06:50:22.074460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
06:50:22.074859 [info ] [MainThread]: 
06:50:22.077907 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
06:50:22.078439 [info ] [Thread-1  ]: 1 of 1 START incremental model public.employee_names ........................... [RUN]
06:50:22.079118 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
06:50:22.079357 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
06:50:22.079576 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
06:50:22.082938 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
06:50:22.083785 [debug] [Thread-1  ]: finished collecting timing info
06:50:22.084051 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
06:50:22.172148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.172491 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

    

  create temporary table "employee_names__dbt_tmp155022143027"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"
  );
  
06:50:22.172710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:50:22.219291 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
06:50:22.229498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.229778 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
06:50:22.246867 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
06:50:22.247140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.247331 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'employee_names__dbt_tmp155022143027'
        
      order by ordinal_position

  
06:50:22.273957 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
06:50:22.280715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.280964 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
06:50:22.299110 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
06:50:22.309821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.310141 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
06:50:22.313123 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
06:50:22.328745 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
06:50:22.329591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.329924 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

    insert into "dbt_training"."public"."employee_names" ("employee_id", "full_name")
    (
        select "employee_id", "full_name"
        from "employee_names__dbt_tmp155022143027"
    )
  
06:50:22.347949 [debug] [Thread-1  ]: SQL status: INSERT 0 2 in 0.02 seconds
06:50:22.357342 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
06:50:22.357616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:50:22.357810 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
06:50:22.358492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
06:50:22.359110 [debug] [Thread-1  ]: finished collecting timing info
06:50:22.359373 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
06:50:22.359900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3e34e64-d602-46b8-8e7b-2f4e0745aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24fc4710>]}
06:50:22.360374 [info ] [Thread-1  ]: 1 of 1 OK created incremental model public.employee_names ...................... [[32mINSERT 0 2[0m in 0.28s]
06:50:22.360926 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
06:50:22.383303 [debug] [MainThread]: Acquiring new postgres connection "master"
06:50:22.383618 [debug] [MainThread]: Using postgres connection "master"
06:50:22.383815 [debug] [MainThread]: On master: BEGIN
06:50:22.383993 [debug] [MainThread]: Opening a new connection, currently in state closed
06:50:22.446786 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
06:50:22.447181 [debug] [MainThread]: On master: COMMIT
06:50:22.447408 [debug] [MainThread]: Using postgres connection "master"
06:50:22.447598 [debug] [MainThread]: On master: COMMIT
06:50:22.448020 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
06:50:22.448246 [debug] [MainThread]: On master: Close
06:50:22.448814 [info ] [MainThread]: 
06:50:22.449195 [info ] [MainThread]: Finished running 1 incremental model in 0.85s.
06:50:22.449541 [debug] [MainThread]: Connection 'master' was properly closed.
06:50:22.449723 [debug] [MainThread]: Connection 'model.dbt_training.employee_names' was properly closed.
06:50:22.473923 [info ] [MainThread]: 
06:50:22.474357 [info ] [MainThread]: [32mCompleted successfully[0m
06:50:22.474784 [info ] [MainThread]: 
06:50:22.475199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
06:50:22.475789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24f69890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24f6a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24f6a690>]}


============================== 2022-05-19 06:58:18.170492 | f6c980e5-866e-40ea-8e62-9ce129da5d6f ==============================
06:58:18.170518 [info ] [MainThread]: Running with dbt=1.1.0
06:58:18.172036 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:58:18.172352 [debug] [MainThread]: Tracking: tracking
06:58:18.196114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3b0fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3b0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3b0fc10>]}
06:58:18.249000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
06:58:18.249326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
06:58:18.257932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c980e5-866e-40ea-8e62-9ce129da5d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e39cf450>]}
06:58:18.264471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6c980e5-866e-40ea-8e62-9ce129da5d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3b0f290>]}
06:58:18.264870 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
06:58:18.265287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c980e5-866e-40ea-8e62-9ce129da5d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3b2a350>]}
06:58:18.267214 [info ] [MainThread]: 
06:58:18.267939 [debug] [MainThread]: Acquiring new postgres connection "master"
06:58:18.268940 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
06:58:18.315839 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
06:58:18.316196 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
06:58:18.316406 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:58:18.375696 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
06:58:18.377317 [debug] [ThreadPool]: On list_dbt_training: Close
06:58:18.378356 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
06:58:18.386915 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
06:58:18.387181 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
06:58:18.387364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:58:18.408515 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
06:58:18.408784 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
06:58:18.408975 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
06:58:18.413264 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
06:58:18.414915 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
06:58:18.415350 [debug] [ThreadPool]: On list_dbt_training_public: Close
06:58:18.420657 [debug] [MainThread]: Using postgres connection "master"
06:58:18.420917 [debug] [MainThread]: On master: BEGIN
06:58:18.421100 [debug] [MainThread]: Opening a new connection, currently in state init
06:58:18.431769 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
06:58:18.432059 [debug] [MainThread]: Using postgres connection "master"
06:58:18.432249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
06:58:18.460512 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
06:58:18.462530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c980e5-866e-40ea-8e62-9ce129da5d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3a9bd90>]}
06:58:18.463016 [debug] [MainThread]: On master: ROLLBACK
06:58:18.463461 [debug] [MainThread]: Using postgres connection "master"
06:58:18.463720 [debug] [MainThread]: On master: BEGIN
06:58:18.464349 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
06:58:18.464620 [debug] [MainThread]: On master: COMMIT
06:58:18.464855 [debug] [MainThread]: Using postgres connection "master"
06:58:18.465076 [debug] [MainThread]: On master: COMMIT
06:58:18.465481 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
06:58:18.465777 [debug] [MainThread]: On master: Close
06:58:18.466337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
06:58:18.466812 [info ] [MainThread]: 
06:58:18.469151 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
06:58:18.469532 [info ] [Thread-1  ]: 1 of 1 START incremental model public.employee_names ........................... [RUN]
06:58:18.470117 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
06:58:18.470333 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
06:58:18.470539 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
06:58:18.473799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
06:58:18.474763 [debug] [Thread-1  ]: finished collecting timing info
06:58:18.475043 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
06:58:18.546052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.546304 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

    

  create temporary table "employee_names__dbt_tmp155818520735"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"
  );
  
06:58:18.546495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:58:18.564775 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
06:58:18.580171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.580446 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
06:58:18.580971 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
06:58:18.581229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.581420 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'employee_names__dbt_tmp155818520735'
        
      order by ordinal_position

  
06:58:18.609269 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
06:58:18.615901 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.616233 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
06:58:18.618977 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
06:58:18.629210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.629505 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
06:58:18.632701 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
06:58:18.648795 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
06:58:18.651454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.651711 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

    insert into "dbt_training"."public"."employee_names" ("employee_id", "full_name")
    (
        select "employee_id", "full_name"
        from "employee_names__dbt_tmp155818520735"
    )
  
06:58:18.652444 [debug] [Thread-1  ]: SQL status: INSERT 0 2 in 0.0 seconds
06:58:18.662174 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
06:58:18.662434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
06:58:18.662664 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
06:58:18.663536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
06:58:18.664153 [debug] [Thread-1  ]: finished collecting timing info
06:58:18.664413 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
06:58:18.664895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c980e5-866e-40ea-8e62-9ce129da5d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3ac7310>]}
06:58:18.665332 [info ] [Thread-1  ]: 1 of 1 OK created incremental model public.employee_names ...................... [[32mINSERT 0 2[0m in 0.19s]
06:58:18.665857 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
06:58:18.684066 [debug] [MainThread]: Acquiring new postgres connection "master"
06:58:18.698065 [debug] [MainThread]: Using postgres connection "master"
06:58:18.698380 [debug] [MainThread]: On master: BEGIN
06:58:18.698583 [debug] [MainThread]: Opening a new connection, currently in state closed
06:58:18.709807 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
06:58:18.710095 [debug] [MainThread]: On master: COMMIT
06:58:18.710292 [debug] [MainThread]: Using postgres connection "master"
06:58:18.710478 [debug] [MainThread]: On master: COMMIT
06:58:18.710757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
06:58:18.710971 [debug] [MainThread]: On master: Close
06:58:18.711391 [info ] [MainThread]: 
06:58:18.711738 [info ] [MainThread]: Finished running 1 incremental model in 0.44s.
06:58:18.712066 [debug] [MainThread]: Connection 'master' was properly closed.
06:58:18.712236 [debug] [MainThread]: Connection 'model.dbt_training.employee_names' was properly closed.
06:58:18.719333 [info ] [MainThread]: 
06:58:18.719723 [info ] [MainThread]: [32mCompleted successfully[0m
06:58:18.720183 [info ] [MainThread]: 
06:58:18.720517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
06:58:18.720936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3ac9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3dba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e3dba7d0>]}


============================== 2022-05-19 07:01:08.365344 | 0bb1638c-70b4-44e7-899d-319ad4a52967 ==============================
07:01:08.365386 [info ] [MainThread]: Running with dbt=1.1.0
07:01:08.366762 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:01:08.367058 [debug] [MainThread]: Tracking: tracking
07:01:08.392844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecb0dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeca567d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecae9f50>]}
07:01:08.446070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:01:08.446626 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models/materialized_dwh/employee_names.sql
07:01:08.497394 [debug] [MainThread]: 1603: static parser failed on materialized_dwh/employee_names.sql
07:01:08.523082 [debug] [MainThread]: 1602: parser fallback to jinja rendering on materialized_dwh/employee_names.sql
07:01:08.534205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb1638c-70b4-44e7-899d-319ad4a52967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeca1c150>]}
07:01:08.540586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb1638c-70b4-44e7-899d-319ad4a52967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecb668d0>]}
07:01:08.541047 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:01:08.541441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb1638c-70b4-44e7-899d-319ad4a52967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecb668d0>]}
07:01:08.542726 [info ] [MainThread]: 
07:01:08.543373 [debug] [MainThread]: Acquiring new postgres connection "master"
07:01:08.544201 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
07:01:08.558435 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
07:01:08.558717 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
07:01:08.558908 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:01:08.616980 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
07:01:08.618667 [debug] [ThreadPool]: On list_dbt_training: Close
07:01:08.619739 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:01:08.628025 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:01:08.628277 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:01:08.628462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:01:08.653183 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
07:01:08.653466 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:01:08.653661 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:01:08.657154 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:01:08.659110 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:01:08.678360 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:01:08.683993 [debug] [MainThread]: Using postgres connection "master"
07:01:08.684432 [debug] [MainThread]: On master: BEGIN
07:01:08.703687 [debug] [MainThread]: Opening a new connection, currently in state init
07:01:08.714129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:01:08.714401 [debug] [MainThread]: Using postgres connection "master"
07:01:08.714593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:01:08.723714 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:01:08.725209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb1638c-70b4-44e7-899d-319ad4a52967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecb56210>]}
07:01:08.725598 [debug] [MainThread]: On master: ROLLBACK
07:01:08.726019 [debug] [MainThread]: Using postgres connection "master"
07:01:08.726232 [debug] [MainThread]: On master: BEGIN
07:01:08.726601 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:01:08.726816 [debug] [MainThread]: On master: COMMIT
07:01:08.727011 [debug] [MainThread]: Using postgres connection "master"
07:01:08.727191 [debug] [MainThread]: On master: COMMIT
07:01:08.727461 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:01:08.727671 [debug] [MainThread]: On master: Close
07:01:08.728059 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:01:08.728419 [info ] [MainThread]: 
07:01:08.730504 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
07:01:08.730940 [info ] [Thread-1  ]: 1 of 1 START incremental model public.employee_names ........................... [RUN]
07:01:08.731584 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
07:01:08.731835 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
07:01:08.732049 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
07:01:08.739756 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
07:01:08.740420 [debug] [Thread-1  ]: finished collecting timing info
07:01:08.740676 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
07:01:08.810612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.810877 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

    

  create temporary table "employee_names__dbt_tmp160108787814"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"



	where "employee_id" not in (SELECT "employee_id" FROM "dbt_training"."public"."employee_names")


  );
  
07:01:08.811074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:01:08.829459 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.02 seconds
07:01:08.839715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.840076 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
07:01:08.851598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:01:08.851881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.852097 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'employee_names__dbt_tmp160108787814'
        
      order by ordinal_position

  
07:01:08.859687 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
07:01:08.866102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.866364 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
07:01:08.868983 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
07:01:08.879072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.879322 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
07:01:08.882153 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
07:01:08.896105 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
07:01:08.897440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.897672 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

    insert into "dbt_training"."public"."employee_names" ("employee_id", "full_name")
    (
        select "employee_id", "full_name"
        from "employee_names__dbt_tmp160108787814"
    )
  
07:01:08.901687 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
07:01:08.910942 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
07:01:08.911443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:08.911708 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
07:01:08.931650 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
07:01:08.932335 [debug] [Thread-1  ]: finished collecting timing info
07:01:08.932591 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
07:01:08.933110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb1638c-70b4-44e7-899d-319ad4a52967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecd7ae90>]}
07:01:08.933591 [info ] [Thread-1  ]: 1 of 1 OK created incremental model public.employee_names ...................... [[32mINSERT 0 0[0m in 0.20s]
07:01:08.934158 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
07:01:08.942633 [debug] [MainThread]: Acquiring new postgres connection "master"
07:01:08.943067 [debug] [MainThread]: Using postgres connection "master"
07:01:08.943292 [debug] [MainThread]: On master: BEGIN
07:01:08.943480 [debug] [MainThread]: Opening a new connection, currently in state closed
07:01:08.960364 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:01:08.960646 [debug] [MainThread]: On master: COMMIT
07:01:08.960845 [debug] [MainThread]: Using postgres connection "master"
07:01:08.961030 [debug] [MainThread]: On master: COMMIT
07:01:08.961291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:01:08.961498 [debug] [MainThread]: On master: Close
07:01:08.961912 [info ] [MainThread]: 
07:01:08.962264 [info ] [MainThread]: Finished running 1 incremental model in 0.42s.
07:01:08.962590 [debug] [MainThread]: Connection 'master' was properly closed.
07:01:08.962764 [debug] [MainThread]: Connection 'model.dbt_training.employee_names' was properly closed.
07:01:08.968542 [info ] [MainThread]: 
07:01:08.968954 [info ] [MainThread]: [32mCompleted successfully[0m
07:01:08.969355 [info ] [MainThread]: 
07:01:08.969684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:01:08.970103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecd6f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecd7fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecd7f150>]}


============================== 2022-05-19 07:01:57.872612 | 5589d7ba-55bd-47f5-a7f9-863e95875dc6 ==============================
07:01:57.872636 [info ] [MainThread]: Running with dbt=1.1.0
07:01:57.874145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:01:57.874408 [debug] [MainThread]: Tracking: tracking
07:01:57.895119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc13dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc12f2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc13bf810>]}
07:01:57.947193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:01:57.947439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:01:57.955125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5589d7ba-55bd-47f5-a7f9-863e95875dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc14e2410>]}
07:01:57.960847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5589d7ba-55bd-47f5-a7f9-863e95875dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc13c4290>]}
07:01:57.961235 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:01:57.961610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5589d7ba-55bd-47f5-a7f9-863e95875dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc13c4290>]}
07:01:57.963073 [info ] [MainThread]: 
07:01:57.963684 [debug] [MainThread]: Acquiring new postgres connection "master"
07:01:57.964527 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
07:01:58.010186 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
07:01:58.010548 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
07:01:58.010854 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:01:58.067457 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
07:01:58.069038 [debug] [ThreadPool]: On list_dbt_training: Close
07:01:58.070126 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:01:58.078258 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:01:58.078887 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:01:58.079082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:01:58.104657 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
07:01:58.105010 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:01:58.105258 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:01:58.109530 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
07:01:58.125932 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:01:58.126338 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:01:58.131183 [debug] [MainThread]: Using postgres connection "master"
07:01:58.131406 [debug] [MainThread]: On master: BEGIN
07:01:58.131585 [debug] [MainThread]: Opening a new connection, currently in state init
07:01:58.153571 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:01:58.153842 [debug] [MainThread]: Using postgres connection "master"
07:01:58.154037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:01:58.162780 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:01:58.164470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5589d7ba-55bd-47f5-a7f9-863e95875dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc0d32950>]}
07:01:58.164897 [debug] [MainThread]: On master: ROLLBACK
07:01:58.165282 [debug] [MainThread]: Using postgres connection "master"
07:01:58.165518 [debug] [MainThread]: On master: BEGIN
07:01:58.166034 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:01:58.166312 [debug] [MainThread]: On master: COMMIT
07:01:58.166550 [debug] [MainThread]: Using postgres connection "master"
07:01:58.166769 [debug] [MainThread]: On master: COMMIT
07:01:58.167170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:01:58.167470 [debug] [MainThread]: On master: Close
07:01:58.167981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:01:58.168427 [info ] [MainThread]: 
07:01:58.170659 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
07:01:58.171019 [info ] [Thread-1  ]: 1 of 1 START incremental model public.employee_names ........................... [RUN]
07:01:58.171659 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
07:01:58.171900 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
07:01:58.172151 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
07:01:58.182098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
07:01:58.182749 [debug] [Thread-1  ]: finished collecting timing info
07:01:58.182983 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
07:01:58.251114 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
07:01:58.251807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:58.252487 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
07:01:58.252696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:01:58.262597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:01:58.262858 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:58.263042 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

  create  table "dbt_training"."public"."employee_names"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"


  );
  
07:01:58.267146 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
07:01:58.281422 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
07:01:58.281668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
07:01:58.281844 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
07:01:58.282477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
07:01:58.283021 [debug] [Thread-1  ]: finished collecting timing info
07:01:58.283234 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
07:01:58.283704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5589d7ba-55bd-47f5-a7f9-863e95875dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc12f2390>]}
07:01:58.284121 [info ] [Thread-1  ]: 1 of 1 OK created incremental model public.employee_names ...................... [[32mSELECT 2[0m in 0.11s]
07:01:58.284649 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
07:01:58.385813 [debug] [MainThread]: Acquiring new postgres connection "master"
07:01:58.386155 [debug] [MainThread]: Using postgres connection "master"
07:01:58.386386 [debug] [MainThread]: On master: BEGIN
07:01:58.386650 [debug] [MainThread]: Opening a new connection, currently in state closed
07:01:58.410523 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:01:58.410834 [debug] [MainThread]: On master: COMMIT
07:01:58.411066 [debug] [MainThread]: Using postgres connection "master"
07:01:58.411254 [debug] [MainThread]: On master: COMMIT
07:01:58.411565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:01:58.411804 [debug] [MainThread]: On master: Close
07:01:58.412228 [info ] [MainThread]: 
07:01:58.412579 [info ] [MainThread]: Finished running 1 incremental model in 0.45s.
07:01:58.412902 [debug] [MainThread]: Connection 'master' was properly closed.
07:01:58.413072 [debug] [MainThread]: Connection 'model.dbt_training.employee_names' was properly closed.
07:01:58.417939 [info ] [MainThread]: 
07:01:58.418319 [info ] [MainThread]: [32mCompleted successfully[0m
07:01:58.418696 [info ] [MainThread]: 
07:01:58.419004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:01:58.419383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc142c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc1557ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc1557190>]}


============================== 2022-05-19 07:25:44.173250 | 2f694dab-4ee2-4957-8b60-d3db9f748bec ==============================
07:25:44.173281 [info ] [MainThread]: Running with dbt=1.1.0
07:25:44.174778 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:25:44.175055 [debug] [MainThread]: Tracking: tracking
07:25:44.218393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabbdfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabbd3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabbd3350>]}
07:25:44.268497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
07:25:44.268930 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/always_fail_test.sql
07:25:44.347949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f694dab-4ee2-4957-8b60-d3db9f748bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabae9210>]}
07:25:44.354812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f694dab-4ee2-4957-8b60-d3db9f748bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabc374d0>]}
07:25:44.355208 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:25:44.355589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f694dab-4ee2-4957-8b60-d3db9f748bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabc37b90>]}
07:25:44.356931 [info ] [MainThread]: 
07:25:44.357692 [debug] [MainThread]: Acquiring new postgres connection "master"
07:25:44.358639 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:25:44.372301 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:25:44.372579 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:25:44.372786 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:25:44.435956 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
07:25:44.436405 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:25:44.436610 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:25:44.442971 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
07:25:44.444857 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:25:44.445338 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:25:44.450464 [debug] [MainThread]: Using postgres connection "master"
07:25:44.450706 [debug] [MainThread]: On master: BEGIN
07:25:44.450881 [debug] [MainThread]: Opening a new connection, currently in state init
07:25:44.477695 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
07:25:44.477958 [debug] [MainThread]: Using postgres connection "master"
07:25:44.478140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:25:44.489063 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:25:44.490796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f694dab-4ee2-4957-8b60-d3db9f748bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabc53490>]}
07:25:44.491255 [debug] [MainThread]: On master: ROLLBACK
07:25:44.491707 [debug] [MainThread]: Using postgres connection "master"
07:25:44.491978 [debug] [MainThread]: On master: BEGIN
07:25:44.492517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:25:44.492846 [debug] [MainThread]: On master: COMMIT
07:25:44.493085 [debug] [MainThread]: Using postgres connection "master"
07:25:44.493330 [debug] [MainThread]: On master: COMMIT
07:25:44.493739 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:25:44.494020 [debug] [MainThread]: On master: Close
07:25:44.494506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:25:44.494842 [info ] [MainThread]: 
07:25:44.497755 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:25:44.498030 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:25:44.498587 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:25:44.498791 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:25:44.498985 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:25:44.500443 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:25:44.501345 [debug] [Thread-1  ]: finished collecting timing info
07:25:44.501567 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:25:44.525049 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:25:44.527050 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:25:44.527293 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:25:44.527472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:25:44.537128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:25:44.548739 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:25:44.549046 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT id
FROM hoge
WHERE true
      
    ) dbt_internal_test
07:25:44.569153 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "hoge" does not exist
LINE 8: FROM hoge
             ^

07:25:44.569569 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:25:44.570229 [debug] [Thread-1  ]: finished collecting timing info
07:25:44.570502 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:25:44.570992 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  relation "hoge" does not exist
  LINE 8: FROM hoge
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:25:44.571354 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.07s]
07:25:44.571946 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:25:44.602636 [debug] [MainThread]: Acquiring new postgres connection "master"
07:25:44.602945 [debug] [MainThread]: Using postgres connection "master"
07:25:44.603144 [debug] [MainThread]: On master: BEGIN
07:25:44.603318 [debug] [MainThread]: Opening a new connection, currently in state closed
07:25:44.627321 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:25:44.627608 [debug] [MainThread]: On master: COMMIT
07:25:44.627799 [debug] [MainThread]: Using postgres connection "master"
07:25:44.627976 [debug] [MainThread]: On master: COMMIT
07:25:44.628276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:25:44.628478 [debug] [MainThread]: On master: Close
07:25:44.628884 [info ] [MainThread]: 
07:25:44.629229 [info ] [MainThread]: Finished running 1 test in 0.27s.
07:25:44.629547 [debug] [MainThread]: Connection 'master' was properly closed.
07:25:44.629714 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:25:44.635747 [info ] [MainThread]: 
07:25:44.636283 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:25:44.636719 [info ] [MainThread]: 
07:25:44.637142 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
07:25:44.637529 [error] [MainThread]:   relation "hoge" does not exist
07:25:44.637850 [error] [MainThread]:   LINE 8: FROM hoge
07:25:44.638152 [error] [MainThread]:                ^
07:25:44.638446 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:25:44.638758 [info ] [MainThread]: 
07:25:44.639071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:25:44.639466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aab600990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabc02410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aabc029d0>]}


============================== 2022-05-19 07:28:47.326180 | b6e8dac3-e267-4cf9-a211-1c514abe2488 ==============================
07:28:47.326205 [info ] [MainThread]: Running with dbt=1.1.0
07:28:47.327732 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:28:47.328067 [debug] [MainThread]: Tracking: tracking
07:28:47.351840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74b56490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74be7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74be7f90>]}
07:28:47.406074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:28:47.406565 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:28:47.483027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6e8dac3-e267-4cf9-a211-1c514abe2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74bdc250>]}
07:28:47.488629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6e8dac3-e267-4cf9-a211-1c514abe2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74c5f450>]}
07:28:47.489017 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:28:47.489394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e8dac3-e267-4cf9-a211-1c514abe2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74c5f8d0>]}
07:28:47.490685 [info ] [MainThread]: 
07:28:47.491400 [debug] [MainThread]: Acquiring new postgres connection "master"
07:28:47.511860 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:28:47.525452 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:28:47.525749 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:28:47.526047 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:28:47.584512 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
07:28:47.584775 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:28:47.584952 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:28:47.588803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:28:47.590445 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:28:47.619539 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:28:47.626491 [debug] [MainThread]: Using postgres connection "master"
07:28:47.642454 [debug] [MainThread]: On master: BEGIN
07:28:47.643557 [debug] [MainThread]: Opening a new connection, currently in state init
07:28:47.671354 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
07:28:47.671741 [debug] [MainThread]: Using postgres connection "master"
07:28:47.672007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:28:47.683688 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:28:47.685551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e8dac3-e267-4cf9-a211-1c514abe2488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74c70a10>]}
07:28:47.685958 [debug] [MainThread]: On master: ROLLBACK
07:28:47.686375 [debug] [MainThread]: Using postgres connection "master"
07:28:47.686634 [debug] [MainThread]: On master: BEGIN
07:28:47.687146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:28:47.687416 [debug] [MainThread]: On master: COMMIT
07:28:47.687652 [debug] [MainThread]: Using postgres connection "master"
07:28:47.687873 [debug] [MainThread]: On master: COMMIT
07:28:47.688284 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:28:47.688639 [debug] [MainThread]: On master: Close
07:28:47.689242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:28:47.689774 [info ] [MainThread]: 
07:28:47.692742 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:28:47.693115 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:28:47.693903 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:28:47.694228 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:28:47.694456 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:28:47.696398 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:28:47.697172 [debug] [Thread-1  ]: finished collecting timing info
07:28:47.697450 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:28:47.722385 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:28:47.741901 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:28:47.742162 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:28:47.742423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:28:47.752496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:28:47.752768 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:28:47.752960 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT id
FROM "dbt_training"."raw"."employees"
WHERE true
      
    ) dbt_internal_test
07:28:47.771764 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:       SELECT id
                     ^

07:28:47.772170 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:28:47.772699 [debug] [Thread-1  ]: finished collecting timing info
07:28:47.772981 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:28:47.773462 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  column "id" does not exist
  LINE 7:       SELECT id
                       ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:28:47.773823 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.08s]
07:28:47.774416 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:28:47.795555 [debug] [MainThread]: Acquiring new postgres connection "master"
07:28:47.796032 [debug] [MainThread]: Using postgres connection "master"
07:28:47.796283 [debug] [MainThread]: On master: BEGIN
07:28:47.796502 [debug] [MainThread]: Opening a new connection, currently in state closed
07:28:47.820899 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:28:47.821191 [debug] [MainThread]: On master: COMMIT
07:28:47.821389 [debug] [MainThread]: Using postgres connection "master"
07:28:47.821777 [debug] [MainThread]: On master: COMMIT
07:28:47.822066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:28:47.840524 [debug] [MainThread]: On master: Close
07:28:47.841076 [info ] [MainThread]: 
07:28:47.841447 [info ] [MainThread]: Finished running 1 test in 0.35s.
07:28:47.841781 [debug] [MainThread]: Connection 'master' was properly closed.
07:28:47.841958 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:28:47.848789 [info ] [MainThread]: 
07:28:47.849233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:28:47.849625 [info ] [MainThread]: 
07:28:47.849957 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
07:28:47.850276 [error] [MainThread]:   column "id" does not exist
07:28:47.850577 [error] [MainThread]:   LINE 7:       SELECT id
07:28:47.850890 [error] [MainThread]:                        ^
07:28:47.851184 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:28:47.851501 [info ] [MainThread]: 
07:28:47.851816 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:28:47.852209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74b00090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca749abb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca749abf50>]}


============================== 2022-05-19 07:29:14.309537 | 5b4a6db3-83ba-43b1-8445-3438742471f8 ==============================
07:29:14.309563 [info ] [MainThread]: Running with dbt=1.1.0
07:29:14.310918 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:29:14.311199 [debug] [MainThread]: Tracking: tracking
07:29:14.335813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee409e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee2e9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee2e9f10>]}
07:29:14.387006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:29:14.387552 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:29:14.463857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b4a6db3-83ba-43b1-8445-3438742471f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee2544d0>]}
07:29:14.469483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b4a6db3-83ba-43b1-8445-3438742471f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee464690>]}
07:29:14.469872 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:29:14.470245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4a6db3-83ba-43b1-8445-3438742471f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee4645d0>]}
07:29:14.471579 [info ] [MainThread]: 
07:29:14.472204 [debug] [MainThread]: Acquiring new postgres connection "master"
07:29:14.473088 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:29:14.486634 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:29:14.486961 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:29:14.487178 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:29:14.537462 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
07:29:14.537751 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:29:14.537944 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:29:14.541314 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:29:14.543003 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:29:14.543363 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:29:14.548666 [debug] [MainThread]: Using postgres connection "master"
07:29:14.548935 [debug] [MainThread]: On master: BEGIN
07:29:14.549120 [debug] [MainThread]: Opening a new connection, currently in state init
07:29:14.572147 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:29:14.572430 [debug] [MainThread]: Using postgres connection "master"
07:29:14.572629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:29:14.583148 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:29:14.584764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4a6db3-83ba-43b1-8445-3438742471f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee473310>]}
07:29:14.603502 [debug] [MainThread]: On master: ROLLBACK
07:29:14.619568 [debug] [MainThread]: Using postgres connection "master"
07:29:14.619921 [debug] [MainThread]: On master: BEGIN
07:29:14.620611 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:29:14.620928 [debug] [MainThread]: On master: COMMIT
07:29:14.621187 [debug] [MainThread]: Using postgres connection "master"
07:29:14.621420 [debug] [MainThread]: On master: COMMIT
07:29:14.621889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:29:14.622208 [debug] [MainThread]: On master: Close
07:29:14.622747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:29:14.623153 [info ] [MainThread]: 
07:29:14.625233 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:29:14.625488 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:29:14.626045 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:29:14.626283 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:29:14.626525 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:29:14.628107 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:29:14.629008 [debug] [Thread-1  ]: finished collecting timing info
07:29:14.629258 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:29:14.653520 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:29:14.654281 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:29:14.654517 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:29:14.654710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:29:14.678915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
07:29:14.693439 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:29:14.693752 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT employee_id
FROM "dbt_training"."raw"."employees"
WHERE true
      
    ) dbt_internal_test
07:29:14.702607 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
07:29:14.718288 [debug] [Thread-1  ]: finished collecting timing info
07:29:14.718566 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:29:14.719460 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:29:14.719929 [error] [Thread-1  ]: 1 of 1 FAIL 2 always_fail_test ................................................. [[31mFAIL 2[0m in 0.09s]
07:29:14.720462 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:29:14.726215 [debug] [MainThread]: Acquiring new postgres connection "master"
07:29:14.726551 [debug] [MainThread]: Using postgres connection "master"
07:29:14.726749 [debug] [MainThread]: On master: BEGIN
07:29:14.726929 [debug] [MainThread]: Opening a new connection, currently in state closed
07:29:14.736306 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:29:14.736595 [debug] [MainThread]: On master: COMMIT
07:29:14.736791 [debug] [MainThread]: Using postgres connection "master"
07:29:14.736974 [debug] [MainThread]: On master: COMMIT
07:29:14.737265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:29:14.737512 [debug] [MainThread]: On master: Close
07:29:14.737959 [info ] [MainThread]: 
07:29:14.738326 [info ] [MainThread]: Finished running 1 test in 0.27s.
07:29:14.738680 [debug] [MainThread]: Connection 'master' was properly closed.
07:29:14.738861 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:29:14.744873 [info ] [MainThread]: 
07:29:14.745351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:29:14.745758 [info ] [MainThread]: 
07:29:14.746106 [error] [MainThread]: [31mFailure in test always_fail_test (tests/always_fail_test.sql)[0m
07:29:14.746442 [error] [MainThread]:   Got 2 results, configured to fail if != 0
07:29:14.746869 [info ] [MainThread]: 
07:29:14.747326 [info ] [MainThread]:   compiled SQL at target/compiled/dbt_training/tests/always_fail_test.sql
07:29:14.747734 [info ] [MainThread]: 
07:29:14.748089 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:29:14.748502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee68d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee68d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee68d790>]}


============================== 2022-05-19 07:30:06.937349 | b8482c1b-e1e8-4a33-b12d-59873489e004 ==============================
07:30:06.937372 [info ] [MainThread]: Running with dbt=1.1.0
07:30:06.938521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:30:06.938797 [debug] [MainThread]: Tracking: tracking
07:30:06.961999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a511fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a511390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a511790>]}
07:30:07.018448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:30:07.019045 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:30:07.096109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8482c1b-e1e8-4a33-b12d-59873489e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a20d750>]}
07:30:07.102977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8482c1b-e1e8-4a33-b12d-59873489e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a565610>]}
07:30:07.103377 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:30:07.103754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8482c1b-e1e8-4a33-b12d-59873489e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a565550>]}
07:30:07.105037 [info ] [MainThread]: 
07:30:07.105598 [debug] [MainThread]: Acquiring new postgres connection "master"
07:30:07.106401 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:30:07.120759 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:30:07.121037 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:30:07.121229 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:30:07.184478 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
07:30:07.184743 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:30:07.184948 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:30:07.188053 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:30:07.189586 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:30:07.189904 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:30:07.194977 [debug] [MainThread]: Using postgres connection "master"
07:30:07.195264 [debug] [MainThread]: On master: BEGIN
07:30:07.195457 [debug] [MainThread]: Opening a new connection, currently in state init
07:30:07.221151 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
07:30:07.221426 [debug] [MainThread]: Using postgres connection "master"
07:30:07.221615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:30:07.233138 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:30:07.244389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8482c1b-e1e8-4a33-b12d-59873489e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a554b10>]}
07:30:07.244873 [debug] [MainThread]: On master: ROLLBACK
07:30:07.245436 [debug] [MainThread]: Using postgres connection "master"
07:30:07.245695 [debug] [MainThread]: On master: BEGIN
07:30:07.246181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:30:07.246415 [debug] [MainThread]: On master: COMMIT
07:30:07.246617 [debug] [MainThread]: Using postgres connection "master"
07:30:07.246804 [debug] [MainThread]: On master: COMMIT
07:30:07.247211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:30:07.247482 [debug] [MainThread]: On master: Close
07:30:07.247968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:30:07.248367 [info ] [MainThread]: 
07:30:07.255086 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:30:07.272023 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:30:07.272728 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:30:07.272960 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:30:07.273170 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:30:07.274735 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:30:07.275489 [debug] [Thread-1  ]: finished collecting timing info
07:30:07.275726 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:30:07.299721 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:30:07.300541 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:30:07.300801 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:30:07.301002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:30:07.327542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
07:30:07.339819 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:30:07.340143 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT employee_id
FROM "dbt_training"."raw"."employees"
WHERE false
      
    ) dbt_internal_test
07:30:07.342516 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
07:30:07.345229 [debug] [Thread-1  ]: finished collecting timing info
07:30:07.345525 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:30:07.345863 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:30:07.346350 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.07s]
07:30:07.346878 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:30:07.360913 [debug] [MainThread]: Acquiring new postgres connection "master"
07:30:07.361497 [debug] [MainThread]: Using postgres connection "master"
07:30:07.361907 [debug] [MainThread]: On master: BEGIN
07:30:07.362209 [debug] [MainThread]: Opening a new connection, currently in state closed
07:30:07.378312 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:30:07.378603 [debug] [MainThread]: On master: COMMIT
07:30:07.378800 [debug] [MainThread]: Using postgres connection "master"
07:30:07.378982 [debug] [MainThread]: On master: COMMIT
07:30:07.379271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:30:07.379475 [debug] [MainThread]: On master: Close
07:30:07.379895 [info ] [MainThread]: 
07:30:07.380254 [info ] [MainThread]: Finished running 1 test in 0.27s.
07:30:07.380591 [debug] [MainThread]: Connection 'master' was properly closed.
07:30:07.380773 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:30:07.387157 [info ] [MainThread]: 
07:30:07.387551 [info ] [MainThread]: [32mCompleted successfully[0m
07:30:07.387937 [info ] [MainThread]: 
07:30:07.388260 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:30:07.388650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a254550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a78e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4a78e1d0>]}


============================== 2022-05-19 07:40:43.904237 | c6e8dc60-1988-41d7-b48f-3afb3231e5af ==============================
07:40:43.904262 [info ] [MainThread]: Running with dbt=1.1.0
07:40:43.905616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:40:43.905850 [debug] [MainThread]: Tracking: tracking
07:40:43.930641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd97407f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd972575d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd974021d0>]}
07:40:44.001200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
07:40:44.001731 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
07:40:44.002031 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/test.sql
07:40:44.002336 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/test.yml
07:40:44.002591 [debug] [MainThread]: Parsing tests/generic/test.sql
07:40:44.044496 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hoge' in the 'models' section of file 'models/hoge.yml'
07:40:44.078170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96c24610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96c1eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96c27d50>]}


============================== 2022-05-19 07:41:19.790174 | 4dbbd6ee-c0fc-4d60-8726-bd26d4e2ba30 ==============================
07:41:19.790197 [info ] [MainThread]: Running with dbt=1.1.0
07:41:19.791894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:41:19.792297 [debug] [MainThread]: Tracking: tracking
07:41:19.811350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612beff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612bd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612bd8110>]}
07:41:19.863961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
07:41:19.864406 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
07:41:19.864707 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/test.sql
07:41:19.864953 [debug] [MainThread]: Parsing tests/generic/test.sql
07:41:19.904061 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hoge' in the 'models' section of file 'models/hoge.yml'
07:41:19.928881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612538b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612538f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9612538d10>]}


============================== 2022-05-19 07:42:09.963299 | 4226a0bc-d167-46e4-9863-373232f19de3 ==============================
07:42:09.963335 [info ] [MainThread]: Running with dbt=1.1.0
07:42:09.964755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:42:09.965012 [debug] [MainThread]: Tracking: tracking
07:42:09.984281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7c02e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7c021d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7c02190>]}
07:42:10.033919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
07:42:10.034379 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
07:42:10.034643 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/test.sql
07:42:10.034861 [debug] [MainThread]: Parsing tests/generic/test.sql
07:42:10.075498 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'test' in the 'models' section of file 'models/hoge.yml'
07:42:10.100580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7c2d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7538750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f7538190>]}


============================== 2022-05-19 07:42:44.846594 | 6c8b245d-abb2-4218-978f-bf963ef5f61c ==============================
07:42:44.846618 [info ] [MainThread]: Running with dbt=1.1.0
07:42:44.848378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:42:44.848646 [debug] [MainThread]: Tracking: tracking
07:42:44.870180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf22e6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf22e6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf22e60d0>]}
07:42:44.925078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
07:42:44.925490 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/test.sql
07:42:44.925808 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
07:42:44.926055 [debug] [MainThread]: Parsing tests/generic/test.sql
07:42:44.967820 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'test' in the 'models' section of file 'models/hoge.yml'
07:42:45.008158 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_test_fuga.72d1cd1d3c' (models/hoge.yml) depends on a node named 'test' which was not found
07:42:45.020757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c8b245d-abb2-4218-978f-bf963ef5f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecbadfd0>]}
07:42:45.027980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c8b245d-abb2-4218-978f-bf963ef5f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2354d10>]}
07:42:45.028396 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:42:45.028762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c8b245d-abb2-4218-978f-bf963ef5f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2354fd0>]}
07:42:45.030083 [info ] [MainThread]: 
07:42:45.030672 [debug] [MainThread]: Acquiring new postgres connection "master"
07:42:45.031568 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:42:45.045014 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:42:45.045280 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:42:45.045470 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:42:45.094771 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
07:42:45.095035 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:42:45.095227 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:42:45.098742 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:42:45.100322 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:42:45.100657 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:42:45.105910 [debug] [MainThread]: Using postgres connection "master"
07:42:45.106158 [debug] [MainThread]: On master: BEGIN
07:42:45.106335 [debug] [MainThread]: Opening a new connection, currently in state init
07:42:45.114943 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:42:45.115201 [debug] [MainThread]: Using postgres connection "master"
07:42:45.115382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:42:45.124127 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:42:45.125430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c8b245d-abb2-4218-978f-bf963ef5f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2354e10>]}
07:42:45.125776 [debug] [MainThread]: On master: ROLLBACK
07:42:45.126154 [debug] [MainThread]: Using postgres connection "master"
07:42:45.126352 [debug] [MainThread]: On master: BEGIN
07:42:45.126948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:42:45.127187 [debug] [MainThread]: On master: COMMIT
07:42:45.127389 [debug] [MainThread]: Using postgres connection "master"
07:42:45.127591 [debug] [MainThread]: On master: COMMIT
07:42:45.127987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:42:45.128287 [debug] [MainThread]: On master: Close
07:42:45.128702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:42:45.129050 [info ] [MainThread]: 
07:42:45.131234 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:42:45.131512 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:42:45.133000 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:42:45.133218 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:42:45.153023 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:42:45.154744 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:42:45.156046 [debug] [Thread-1  ]: finished collecting timing info
07:42:45.156314 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:42:45.179516 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:42:45.180464 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:42:45.180672 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:42:45.180847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:42:45.189954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:42:45.190212 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:42:45.190397 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT employee_id
FROM "dbt_training"."raw"."employees"
WHERE false
      
    ) dbt_internal_test
07:42:45.191523 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
07:42:45.194150 [debug] [Thread-1  ]: finished collecting timing info
07:42:45.194431 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:42:45.194752 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:42:45.195189 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.06s]
07:42:45.195687 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:42:45.231402 [debug] [MainThread]: Acquiring new postgres connection "master"
07:42:45.231983 [debug] [MainThread]: Using postgres connection "master"
07:42:45.232206 [debug] [MainThread]: On master: BEGIN
07:42:45.251138 [debug] [MainThread]: Opening a new connection, currently in state closed
07:42:45.261027 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:42:45.273630 [debug] [MainThread]: On master: COMMIT
07:42:45.274202 [debug] [MainThread]: Using postgres connection "master"
07:42:45.274475 [debug] [MainThread]: On master: COMMIT
07:42:45.274904 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:42:45.275172 [debug] [MainThread]: On master: Close
07:42:45.275686 [info ] [MainThread]: 
07:42:45.276114 [info ] [MainThread]: Finished running 1 test in 0.25s.
07:42:45.276511 [debug] [MainThread]: Connection 'master' was properly closed.
07:42:45.276719 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:42:45.283600 [info ] [MainThread]: 
07:42:45.284061 [info ] [MainThread]: [32mCompleted successfully[0m
07:42:45.284571 [info ] [MainThread]: 
07:42:45.284952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:42:45.285459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf26bae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf26ba7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf26baa90>]}


============================== 2022-05-19 07:43:04.838218 | fa911a34-a355-4a0c-9687-cb16096de73a ==============================
07:43:04.838236 [info ] [MainThread]: Running with dbt=1.1.0
07:43:04.839651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:43:04.839896 [debug] [MainThread]: Tracking: tracking
07:43:04.857768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0c00fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0a38510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0acde90>]}
07:43:04.907164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:43:04.907698 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/hoge.yml
07:43:04.949406 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hoge' in the 'models' section of file 'models/hoge.yml'
07:43:04.987350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_hoge_fuga.c7538fa4ef' (models/hoge.yml) depends on a node named 'hoge' which was not found
07:43:04.997757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa911a34-a355-4a0c-9687-cb16096de73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ab2ad750>]}
07:43:05.003302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa911a34-a355-4a0c-9687-cb16096de73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0c61650>]}
07:43:05.003695 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:43:05.004048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa911a34-a355-4a0c-9687-cb16096de73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0c615d0>]}
07:43:05.005477 [info ] [MainThread]: 
07:43:05.006118 [debug] [MainThread]: Acquiring new postgres connection "master"
07:43:05.006980 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:43:05.020081 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:43:05.020340 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:43:05.020542 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:43:05.059347 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
07:43:05.059638 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:43:05.059818 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:43:05.062782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:43:05.064282 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:43:05.064648 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:43:05.069298 [debug] [MainThread]: Using postgres connection "master"
07:43:05.069493 [debug] [MainThread]: On master: BEGIN
07:43:05.069659 [debug] [MainThread]: Opening a new connection, currently in state init
07:43:05.078163 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:43:05.078406 [debug] [MainThread]: Using postgres connection "master"
07:43:05.078593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:43:05.087181 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:43:05.088981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa911a34-a355-4a0c-9687-cb16096de73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0c7ea90>]}
07:43:05.089402 [debug] [MainThread]: On master: ROLLBACK
07:43:05.089827 [debug] [MainThread]: Using postgres connection "master"
07:43:05.090097 [debug] [MainThread]: On master: BEGIN
07:43:05.090630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:43:05.090912 [debug] [MainThread]: On master: COMMIT
07:43:05.091156 [debug] [MainThread]: Using postgres connection "master"
07:43:05.091379 [debug] [MainThread]: On master: COMMIT
07:43:05.091777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:43:05.092065 [debug] [MainThread]: On master: Close
07:43:05.092556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:43:05.092996 [info ] [MainThread]: 
07:43:05.095544 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:43:05.095833 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:43:05.096401 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:43:05.096611 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:43:05.096811 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:43:05.098296 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:43:05.098829 [debug] [Thread-1  ]: finished collecting timing info
07:43:05.099041 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:43:05.120438 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:43:05.128908 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:43:05.129176 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:43:05.129361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:43:05.138561 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:43:05.152357 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:43:05.153427 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT employee_id
FROM "dbt_training"."raw"."employees"
WHERE false
      
    ) dbt_internal_test
07:43:05.155355 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
07:43:05.158169 [debug] [Thread-1  ]: finished collecting timing info
07:43:05.158473 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:43:05.158946 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:43:05.159514 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.06s]
07:43:05.160038 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:43:05.195990 [debug] [MainThread]: Acquiring new postgres connection "master"
07:43:05.196363 [debug] [MainThread]: Using postgres connection "master"
07:43:05.196599 [debug] [MainThread]: On master: BEGIN
07:43:05.196815 [debug] [MainThread]: Opening a new connection, currently in state closed
07:43:05.248505 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
07:43:05.256140 [debug] [MainThread]: On master: COMMIT
07:43:05.256441 [debug] [MainThread]: Using postgres connection "master"
07:43:05.257265 [debug] [MainThread]: On master: COMMIT
07:43:05.257653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:43:05.257875 [debug] [MainThread]: On master: Close
07:43:05.258300 [info ] [MainThread]: 
07:43:05.258694 [info ] [MainThread]: Finished running 1 test in 0.25s.
07:43:05.277725 [debug] [MainThread]: Connection 'master' was properly closed.
07:43:05.277989 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:43:05.283803 [info ] [MainThread]: 
07:43:05.284200 [info ] [MainThread]: [32mCompleted successfully[0m
07:43:05.284612 [info ] [MainThread]: 
07:43:05.285066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:43:05.285476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b09627d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b09deb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b09de790>]}


============================== 2022-05-19 07:44:37.041823 | 2b7c8cd0-a339-48c3-9023-613158eb25a2 ==============================
07:44:37.041843 [info ] [MainThread]: Running with dbt=1.1.0
07:44:37.043131 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:44:37.043369 [debug] [MainThread]: Tracking: tracking
07:44:37.070521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19710>]}
07:44:37.121244 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
07:44:37.121562 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://tests/always_fail_test.sql
07:44:37.162499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b7c8cd0-a339-48c3-9023-613158eb25a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7c638b50>]}
07:44:37.168210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b7c8cd0-a339-48c3-9023-613158eb25a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc41690>]}
07:44:37.168560 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:44:37.168936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b7c8cd0-a339-48c3-9023-613158eb25a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc41a90>]}
07:44:37.170192 [info ] [MainThread]: 
07:44:37.170563 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:44:37.175747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7cc19450>]}


============================== 2022-05-19 07:46:06.926373 | e2c141fe-7e04-4ae7-af15-40d048da3955 ==============================
07:46:06.926392 [info ] [MainThread]: Running with dbt=1.1.0
07:46:06.927480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:46:06.927714 [debug] [MainThread]: Tracking: tracking
07:46:06.950053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992ba9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992adc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992ba9fd0>]}
07:46:06.985783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992d4c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992d4cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992d4c490>]}


============================== 2022-05-19 07:47:40.056422 | ecda7a30-ad8b-494a-b56b-3cf912576d46 ==============================
07:47:40.056441 [info ] [MainThread]: Running with dbt=1.1.0
07:47:40.057596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:47:40.057857 [debug] [MainThread]: Tracking: tracking
07:47:40.076461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fc40dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fc22a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f934f690>]}
07:47:40.132401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:47:40.132652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:47:40.140453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecda7a30-ad8b-494a-b56b-3cf912576d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fbedf3d0>]}
07:47:40.146608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecda7a30-ad8b-494a-b56b-3cf912576d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fc1fba90>]}
07:47:40.147006 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:47:40.147360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecda7a30-ad8b-494a-b56b-3cf912576d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fc455050>]}
07:47:40.148673 [info ] [MainThread]: 
07:47:40.149021 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:47:40.182568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fbd44510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fbd8e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6fbd88690>]}


============================== 2022-05-19 07:49:54.779353 | cd192d14-9db9-42ef-8362-31ba4ddcd9d6 ==============================
07:49:54.779376 [info ] [MainThread]: Running with dbt=1.1.0
07:49:54.781469 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:49:54.781717 [debug] [MainThread]: Tracking: tracking
07:49:54.803913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bc02f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bb56350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bc02050>]}
07:49:54.835637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bc8b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bc8b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74bc8bfd0>]}


============================== 2022-05-19 07:51:09.426737 | 25364fea-7ab9-40fd-9861-123656d62f96 ==============================
07:51:09.426771 [info ] [MainThread]: Running with dbt=1.1.0
07:51:09.428013 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:51:09.428238 [debug] [MainThread]: Tracking: tracking
07:51:09.450235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c39fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c39390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c39450>]}
07:51:09.484371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c8af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c8a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c35c8a150>]}


============================== 2022-05-19 07:52:02.743137 | 47c72587-8935-4661-8ade-6bce6c826331 ==============================
07:52:02.743157 [info ] [MainThread]: Running with dbt=1.1.0
07:52:02.744378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:52:02.744600 [debug] [MainThread]: Tracking: tracking
07:52:02.764451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae840ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae82e9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae840f3d0>]}
07:52:02.795428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae8461450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae8461350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae8461750>]}


============================== 2022-05-19 07:52:23.667001 | 224b7427-185b-4cdf-86a4-b3f5d47b00ad ==============================
07:52:23.667024 [info ] [MainThread]: Running with dbt=1.1.0
07:52:23.668385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:52:23.668628 [debug] [MainThread]: Tracking: tracking
07:52:23.687925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb08f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb02090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb02050>]}
07:52:23.740969 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 0 files changed.
07:52:23.754568 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/always_fail_test.sql
07:52:23.755258 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://tests/generic/test.sql
07:52:23.755688 [debug] [MainThread]: Parsing tests/generic/always_fail_test.sql
07:52:23.801099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '224b7427-185b-4cdf-86a4-b3f5d47b00ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c5c14d0>]}
07:52:23.807111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '224b7427-185b-4cdf-86a4-b3f5d47b00ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb63690>]}
07:52:23.807530 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:52:23.807928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224b7427-185b-4cdf-86a4-b3f5d47b00ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb63a90>]}
07:52:23.809131 [info ] [MainThread]: 
07:52:23.809528 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:52:23.814677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb543d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb54b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cb54790>]}


============================== 2022-05-19 07:53:12.454918 | fba24082-468c-4696-8fe5-5ea9c94695d6 ==============================
07:53:12.454941 [info ] [MainThread]: Running with dbt=1.1.0
07:53:12.456555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:53:12.456882 [debug] [MainThread]: Tracking: tracking
07:53:12.477690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1c0be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1af2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1af76d0>]}
07:53:12.527794 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
07:53:12.528213 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/always_fail_test.sql
07:53:12.528442 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://tests/generic/always_fail_test.sql
07:53:12.601936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba24082-468c-4696-8fe5-5ea9c94695d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1afb610>]}
07:53:12.607563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba24082-468c-4696-8fe5-5ea9c94695d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1c39950>]}
07:53:12.607945 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:53:12.608323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba24082-468c-4696-8fe5-5ea9c94695d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1c39dd0>]}
07:53:12.609618 [info ] [MainThread]: 
07:53:12.610231 [debug] [MainThread]: Acquiring new postgres connection "master"
07:53:12.611479 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:53:12.625534 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:53:12.625797 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:53:12.625983 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:53:12.692014 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
07:53:12.692278 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:53:12.692462 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:53:12.695625 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:53:12.697186 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:53:12.697546 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:53:12.702408 [debug] [MainThread]: Using postgres connection "master"
07:53:12.702637 [debug] [MainThread]: On master: BEGIN
07:53:12.702817 [debug] [MainThread]: Opening a new connection, currently in state init
07:53:12.711499 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:53:12.712217 [debug] [MainThread]: Using postgres connection "master"
07:53:12.712442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:53:12.722159 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:53:12.733447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba24082-468c-4696-8fe5-5ea9c94695d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1c49f90>]}
07:53:12.733905 [debug] [MainThread]: On master: ROLLBACK
07:53:12.734359 [debug] [MainThread]: Using postgres connection "master"
07:53:12.734631 [debug] [MainThread]: On master: BEGIN
07:53:12.735151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:53:12.735436 [debug] [MainThread]: On master: COMMIT
07:53:12.735680 [debug] [MainThread]: Using postgres connection "master"
07:53:12.735904 [debug] [MainThread]: On master: COMMIT
07:53:12.736260 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:53:12.736528 [debug] [MainThread]: On master: Close
07:53:12.737349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:53:12.756948 [info ] [MainThread]: 
07:53:12.760007 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:53:12.760333 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:53:12.760948 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:53:12.761175 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:53:12.761385 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:53:12.762986 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:53:12.763654 [debug] [Thread-1  ]: finished collecting timing info
07:53:12.763918 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:53:12.787545 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:53:12.788150 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:53:12.788346 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:53:12.788515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:53:12.798112 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:53:12.798373 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:53:12.798556 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select id
from hoge
where true
      
    ) dbt_internal_test
07:53:12.799157 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "hoge" does not exist
LINE 8: from hoge
             ^

07:53:12.799353 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:53:12.799737 [debug] [Thread-1  ]: finished collecting timing info
07:53:12.799938 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:53:12.800303 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  relation "hoge" does not exist
  LINE 8: from hoge
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:53:12.800579 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.04s]
07:53:12.801048 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:53:12.863987 [debug] [MainThread]: Acquiring new postgres connection "master"
07:53:12.864446 [debug] [MainThread]: Using postgres connection "master"
07:53:12.864749 [debug] [MainThread]: On master: BEGIN
07:53:12.865150 [debug] [MainThread]: Opening a new connection, currently in state closed
07:53:12.875561 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:53:12.875843 [debug] [MainThread]: On master: COMMIT
07:53:12.876035 [debug] [MainThread]: Using postgres connection "master"
07:53:12.876218 [debug] [MainThread]: On master: COMMIT
07:53:12.882246 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
07:53:12.882526 [debug] [MainThread]: On master: Close
07:53:12.882967 [info ] [MainThread]: 
07:53:12.883325 [info ] [MainThread]: Finished running 1 test in 0.27s.
07:53:12.883660 [debug] [MainThread]: Connection 'master' was properly closed.
07:53:12.883838 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:53:12.889762 [info ] [MainThread]: 
07:53:12.890187 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:53:12.890615 [info ] [MainThread]: 
07:53:12.891062 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
07:53:12.891398 [error] [MainThread]:   relation "hoge" does not exist
07:53:12.891705 [error] [MainThread]:   LINE 8: from hoge
07:53:12.892004 [error] [MainThread]:                ^
07:53:12.892309 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:53:12.892625 [info ] [MainThread]: 
07:53:12.892940 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:53:12.893449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1cd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1ce9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d1ce9b90>]}


============================== 2022-05-19 07:53:55.275598 | 4c604f37-1b80-4bc8-a536-9df127177d72 ==============================
07:53:55.275621 [info ] [MainThread]: Running with dbt=1.1.0
07:53:55.277003 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:53:55.277248 [debug] [MainThread]: Tracking: tracking
07:53:55.295746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac02f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ab0c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ab56710>]}
07:53:55.344889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:53:55.345383 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:53:55.417656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c604f37-1b80-4bc8-a536-9df127177d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ab56390>]}
07:53:55.423023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c604f37-1b80-4bc8-a536-9df127177d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac63bd0>]}
07:53:55.423383 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:53:55.423837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c604f37-1b80-4bc8-a536-9df127177d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac63050>]}
07:53:55.425183 [info ] [MainThread]: 
07:53:55.425755 [debug] [MainThread]: Acquiring new postgres connection "master"
07:53:55.426604 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:53:55.439728 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:53:55.439992 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:53:55.440188 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:53:55.501682 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
07:53:55.510021 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:53:55.510308 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:53:55.514071 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:53:55.525626 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:53:55.526036 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:53:55.530763 [debug] [MainThread]: Using postgres connection "master"
07:53:55.530979 [debug] [MainThread]: On master: BEGIN
07:53:55.531157 [debug] [MainThread]: Opening a new connection, currently in state init
07:53:55.544761 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:53:55.545038 [debug] [MainThread]: Using postgres connection "master"
07:53:55.545235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:53:55.553802 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:53:55.555206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c604f37-1b80-4bc8-a536-9df127177d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac722d0>]}
07:53:55.555567 [debug] [MainThread]: On master: ROLLBACK
07:53:55.555889 [debug] [MainThread]: Using postgres connection "master"
07:53:55.556081 [debug] [MainThread]: On master: BEGIN
07:53:55.556456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:53:55.556687 [debug] [MainThread]: On master: COMMIT
07:53:55.556886 [debug] [MainThread]: Using postgres connection "master"
07:53:55.557071 [debug] [MainThread]: On master: COMMIT
07:53:55.557406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:53:55.557628 [debug] [MainThread]: On master: Close
07:53:55.558046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:53:55.558391 [info ] [MainThread]: 
07:53:55.560432 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:53:55.560684 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:53:55.561228 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:53:55.561421 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:53:55.561611 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:53:55.563078 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:53:55.564323 [debug] [Thread-1  ]: finished collecting timing info
07:53:55.564562 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:53:55.588925 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:53:55.603504 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:53:55.603782 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:53:55.603976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:53:55.612716 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:53:55.612993 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:53:55.613195 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select id
from "dbt_training"."raw"."employees"
where true
      
    ) dbt_internal_test
07:53:55.613922 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:       select id
                     ^

07:53:55.614167 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:53:55.614599 [debug] [Thread-1  ]: finished collecting timing info
07:53:55.614835 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:53:55.615269 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  column "id" does not exist
  LINE 7:       select id
                       ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:53:55.615641 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.05s]
07:53:55.616276 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:53:55.664778 [debug] [MainThread]: Acquiring new postgres connection "master"
07:53:55.665077 [debug] [MainThread]: Using postgres connection "master"
07:53:55.665270 [debug] [MainThread]: On master: BEGIN
07:53:55.665443 [debug] [MainThread]: Opening a new connection, currently in state closed
07:53:55.675644 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:53:55.675944 [debug] [MainThread]: On master: COMMIT
07:53:55.676150 [debug] [MainThread]: Using postgres connection "master"
07:53:55.676335 [debug] [MainThread]: On master: COMMIT
07:53:55.676657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:53:55.676922 [debug] [MainThread]: On master: Close
07:53:55.677369 [info ] [MainThread]: 
07:53:55.677729 [info ] [MainThread]: Finished running 1 test in 0.25s.
07:53:55.678073 [debug] [MainThread]: Connection 'master' was properly closed.
07:53:55.678257 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:53:55.684449 [info ] [MainThread]: 
07:53:55.684825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:53:55.685182 [info ] [MainThread]: 
07:53:55.685489 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
07:53:55.685790 [error] [MainThread]:   column "id" does not exist
07:53:55.686101 [error] [MainThread]:   LINE 7:       select id
07:53:55.686400 [error] [MainThread]:                        ^
07:53:55.686804 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
07:53:55.687142 [info ] [MainThread]: 
07:53:55.687480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:53:55.687968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ab1ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac2d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ac2d1d0>]}


============================== 2022-05-19 07:54:12.565144 | 258c5a53-8135-44b6-9695-a302802932ab ==============================
07:54:12.565164 [info ] [MainThread]: Running with dbt=1.1.0
07:54:12.565861 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:54:12.566081 [debug] [MainThread]: Tracking: tracking
07:54:12.581257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12750ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12750e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12750e750>]}
07:54:12.617599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:54:12.618070 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:54:12.686012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '258c5a53-8135-44b6-9695-a302802932ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12705d3d0>]}
07:54:12.691006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '258c5a53-8135-44b6-9695-a302802932ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1275643d0>]}
07:54:12.691347 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:54:12.691682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258c5a53-8135-44b6-9695-a302802932ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127564a10>]}
07:54:12.692855 [info ] [MainThread]: 
07:54:12.693374 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:12.694145 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:54:12.706644 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:54:12.706886 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:54:12.707056 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:54:12.738135 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
07:54:12.738381 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:54:12.738551 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:54:12.741724 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
07:54:12.743202 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:54:12.743646 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:54:12.748374 [debug] [MainThread]: Using postgres connection "master"
07:54:12.748622 [debug] [MainThread]: On master: BEGIN
07:54:12.748795 [debug] [MainThread]: Opening a new connection, currently in state init
07:54:12.758076 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:54:12.774024 [debug] [MainThread]: Using postgres connection "master"
07:54:12.774677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:54:12.798171 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
07:54:12.815874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258c5a53-8135-44b6-9695-a302802932ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12758b790>]}
07:54:12.816409 [debug] [MainThread]: On master: ROLLBACK
07:54:12.816890 [debug] [MainThread]: Using postgres connection "master"
07:54:12.817156 [debug] [MainThread]: On master: BEGIN
07:54:12.817735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:54:12.818023 [debug] [MainThread]: On master: COMMIT
07:54:12.818265 [debug] [MainThread]: Using postgres connection "master"
07:54:12.818486 [debug] [MainThread]: On master: COMMIT
07:54:12.818837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:12.819102 [debug] [MainThread]: On master: Close
07:54:12.819560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:54:12.819977 [info ] [MainThread]: 
07:54:12.821950 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:54:12.822247 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:54:12.822811 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:54:12.823026 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:54:12.823229 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:54:12.824751 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:54:12.825448 [debug] [Thread-1  ]: finished collecting timing info
07:54:12.825682 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:54:12.849135 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:54:12.849792 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:54:12.849998 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:54:12.850172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:54:12.859361 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:54:12.872373 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:54:12.873022 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where true
      
    ) dbt_internal_test
07:54:12.874730 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
07:54:12.877392 [debug] [Thread-1  ]: finished collecting timing info
07:54:12.877656 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:54:12.887428 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:54:12.888297 [error] [Thread-1  ]: 1 of 1 FAIL 2 always_fail_test ................................................. [[31mFAIL 2[0m in 0.07s]
07:54:12.889094 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:54:12.925816 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:12.926126 [debug] [MainThread]: Using postgres connection "master"
07:54:12.926324 [debug] [MainThread]: On master: BEGIN
07:54:12.926500 [debug] [MainThread]: Opening a new connection, currently in state closed
07:54:12.946927 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
07:54:12.947230 [debug] [MainThread]: On master: COMMIT
07:54:12.947429 [debug] [MainThread]: Using postgres connection "master"
07:54:12.947611 [debug] [MainThread]: On master: COMMIT
07:54:12.947902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:12.948115 [debug] [MainThread]: On master: Close
07:54:12.948540 [info ] [MainThread]: 
07:54:12.948875 [info ] [MainThread]: Finished running 1 test in 0.26s.
07:54:12.949189 [debug] [MainThread]: Connection 'master' was properly closed.
07:54:12.949358 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:54:12.973404 [info ] [MainThread]: 
07:54:12.973866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:54:12.974305 [info ] [MainThread]: 
07:54:12.974698 [error] [MainThread]: [31mFailure in test always_fail_test (tests/always_fail_test.sql)[0m
07:54:12.975082 [error] [MainThread]:   Got 2 results, configured to fail if != 0
07:54:12.975445 [info ] [MainThread]: 
07:54:12.975820 [info ] [MainThread]:   compiled SQL at target/compiled/dbt_training/tests/always_fail_test.sql
07:54:12.976203 [info ] [MainThread]: 
07:54:12.976565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
07:54:12.977014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1275804d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12733a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12767fdd0>]}


============================== 2022-05-19 07:54:29.801967 | 091baf04-56cf-4942-80f9-a00c074ac1d2 ==============================
07:54:29.801986 [info ] [MainThread]: Running with dbt=1.1.0
07:54:29.802694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
07:54:29.802918 [debug] [MainThread]: Tracking: tracking
07:54:29.819801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3ae1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3ae11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3ae1090>]}
07:54:29.858165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:54:29.858862 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
07:54:29.930935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '091baf04-56cf-4942-80f9-a00c074ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3593490>]}
07:54:29.936601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '091baf04-56cf-4942-80f9-a00c074ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3b415d0>]}
07:54:29.936984 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:54:29.937351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091baf04-56cf-4942-80f9-a00c074ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3b41d90>]}
07:54:29.938604 [info ] [MainThread]: 
07:54:29.939176 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:29.940046 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
07:54:29.954338 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:54:29.954606 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
07:54:29.954790 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:54:29.977386 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
07:54:29.977650 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
07:54:29.977838 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
07:54:29.994645 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.02 seconds
07:54:29.996342 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
07:54:29.996842 [debug] [ThreadPool]: On list_dbt_training_public: Close
07:54:30.001619 [debug] [MainThread]: Using postgres connection "master"
07:54:30.001840 [debug] [MainThread]: On master: BEGIN
07:54:30.002014 [debug] [MainThread]: Opening a new connection, currently in state init
07:54:30.013084 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:54:30.013360 [debug] [MainThread]: Using postgres connection "master"
07:54:30.013549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:54:30.022302 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:54:30.034298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091baf04-56cf-4942-80f9-a00c074ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3b50090>]}
07:54:30.034672 [debug] [MainThread]: On master: ROLLBACK
07:54:30.041385 [debug] [MainThread]: Using postgres connection "master"
07:54:30.041776 [debug] [MainThread]: On master: BEGIN
07:54:30.042527 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
07:54:30.042795 [debug] [MainThread]: On master: COMMIT
07:54:30.043002 [debug] [MainThread]: Using postgres connection "master"
07:54:30.043189 [debug] [MainThread]: On master: COMMIT
07:54:30.043508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:30.043760 [debug] [MainThread]: On master: Close
07:54:30.044196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:54:30.044592 [info ] [MainThread]: 
07:54:30.046682 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
07:54:30.064947 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
07:54:30.065672 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
07:54:30.065944 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
07:54:30.066152 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
07:54:30.067660 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
07:54:30.068340 [debug] [Thread-1  ]: finished collecting timing info
07:54:30.068564 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
07:54:30.090763 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
07:54:30.091342 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:54:30.091532 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
07:54:30.091700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:54:30.101968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
07:54:30.102221 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
07:54:30.102393 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
07:54:30.103583 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
07:54:30.105611 [debug] [Thread-1  ]: finished collecting timing info
07:54:30.105826 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
07:54:30.106102 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
07:54:30.106534 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.04s]
07:54:30.107009 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
07:54:30.146958 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:30.163901 [debug] [MainThread]: Using postgres connection "master"
07:54:30.164306 [debug] [MainThread]: On master: BEGIN
07:54:30.164550 [debug] [MainThread]: Opening a new connection, currently in state closed
07:54:30.174371 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:54:30.174640 [debug] [MainThread]: On master: COMMIT
07:54:30.174834 [debug] [MainThread]: Using postgres connection "master"
07:54:30.175028 [debug] [MainThread]: On master: COMMIT
07:54:30.175352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:30.175618 [debug] [MainThread]: On master: Close
07:54:30.176037 [info ] [MainThread]: 
07:54:30.176385 [info ] [MainThread]: Finished running 1 test in 0.24s.
07:54:30.176710 [debug] [MainThread]: Connection 'master' was properly closed.
07:54:30.176879 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
07:54:30.182726 [info ] [MainThread]: 
07:54:30.183106 [info ] [MainThread]: [32mCompleted successfully[0m
07:54:30.183489 [info ] [MainThread]: 
07:54:30.183803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
07:54:30.184195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3bc59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3d6c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3d6c690>]}


============================== 2022-05-19 08:12:42.951814 | 501234cb-35d6-4465-96d9-52f37641806d ==============================
08:12:42.951838 [info ] [MainThread]: Running with dbt=1.1.0
08:12:42.953184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:12:42.953423 [debug] [MainThread]: Tracking: tracking
08:12:42.977140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0afc88d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0afc69f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0afb87350>]}
08:12:43.026779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
08:12:43.027250 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
08:12:43.070306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af517790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af4c46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af4c45d0>]}


============================== 2022-05-19 08:16:21.596094 | 837fb229-360b-49e8-ad2c-aa94c6ccd1a9 ==============================
08:16:21.596112 [info ] [MainThread]: Running with dbt=1.1.0
08:16:21.597457 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:16:21.597655 [debug] [MainThread]: Tracking: tracking
08:16:21.617691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e408d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e21cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e21c750>]}
08:16:21.671521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
08:16:21.672007 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.yml
08:16:21.672311 [debug] [MainThread]: Partial parsing: added file: dbt_training://tests/generic/test.sql
08:16:21.672555 [debug] [MainThread]: Parsing tests/generic/test.sql
08:16:21.711464 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hoge' in the 'models' section of file 'models/hoge.yml'
08:16:21.751532 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_hoge_fuga.c7538fa4ef' (models/hoge.yml) depends on a node named 'hoge' which was not found
08:16:21.762814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '837fb229-360b-49e8-ad2c-aa94c6ccd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2e2190>]}
08:16:21.775110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '837fb229-360b-49e8-ad2c-aa94c6ccd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e464c10>]}
08:16:21.775510 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:16:21.775873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '837fb229-360b-49e8-ad2c-aa94c6ccd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e4811d0>]}
08:16:21.777210 [info ] [MainThread]: 
08:16:21.777855 [debug] [MainThread]: Acquiring new postgres connection "master"
08:16:21.778988 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:16:21.792165 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:16:21.792453 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:16:21.792647 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:16:21.844661 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
08:16:21.845026 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:16:21.845232 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:16:21.848925 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:16:21.850490 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:16:21.850855 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:16:21.855734 [debug] [MainThread]: Using postgres connection "master"
08:16:21.855970 [debug] [MainThread]: On master: BEGIN
08:16:21.856143 [debug] [MainThread]: Opening a new connection, currently in state init
08:16:21.864894 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:16:21.865108 [debug] [MainThread]: Using postgres connection "master"
08:16:21.865281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:16:21.874224 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:16:21.897750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '837fb229-360b-49e8-ad2c-aa94c6ccd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e472cd0>]}
08:16:21.898321 [debug] [MainThread]: On master: ROLLBACK
08:16:21.898873 [debug] [MainThread]: Using postgres connection "master"
08:16:21.899169 [debug] [MainThread]: On master: BEGIN
08:16:21.899678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:16:21.900059 [debug] [MainThread]: On master: COMMIT
08:16:21.900301 [debug] [MainThread]: Using postgres connection "master"
08:16:21.900522 [debug] [MainThread]: On master: COMMIT
08:16:21.900876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:16:21.901131 [debug] [MainThread]: On master: Close
08:16:21.901604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:16:21.902030 [info ] [MainThread]: 
08:16:21.904751 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:16:21.921830 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:16:21.922698 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:16:21.922984 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:16:21.923242 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:16:21.925084 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:16:21.926413 [debug] [Thread-1  ]: finished collecting timing info
08:16:21.926709 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:16:21.950562 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:16:21.951208 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:16:21.951415 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:16:21.951593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:16:21.961152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:16:21.961428 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:16:21.961620 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
08:16:21.962822 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:16:21.965045 [debug] [Thread-1  ]: finished collecting timing info
08:16:21.965270 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:16:21.965612 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:16:21.966081 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.04s]
08:16:21.966578 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:16:22.005711 [debug] [MainThread]: Acquiring new postgres connection "master"
08:16:22.014645 [debug] [MainThread]: Using postgres connection "master"
08:16:22.014996 [debug] [MainThread]: On master: BEGIN
08:16:22.015188 [debug] [MainThread]: Opening a new connection, currently in state closed
08:16:22.023878 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:16:22.024163 [debug] [MainThread]: On master: COMMIT
08:16:22.024358 [debug] [MainThread]: Using postgres connection "master"
08:16:22.024538 [debug] [MainThread]: On master: COMMIT
08:16:22.024847 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:16:22.025089 [debug] [MainThread]: On master: Close
08:16:22.025547 [info ] [MainThread]: 
08:16:22.025906 [info ] [MainThread]: Finished running 1 test in 0.25s.
08:16:22.026230 [debug] [MainThread]: Connection 'master' was properly closed.
08:16:22.026474 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:16:22.032225 [info ] [MainThread]: 
08:16:22.032628 [info ] [MainThread]: [32mCompleted successfully[0m
08:16:22.033012 [info ] [MainThread]: 
08:16:22.033327 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:16:22.033713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e78f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e78f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e78f850>]}


============================== 2022-05-19 08:20:45.853178 | 9402af49-f518-4ca4-a333-c828cfa222fe ==============================
08:20:45.853211 [info ] [MainThread]: Running with dbt=1.1.0
08:20:45.854481 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:20:45.854752 [debug] [MainThread]: Tracking: tracking
08:20:45.874580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8c34e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8ac09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8c34710>]}
08:20:45.928455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:20:45.928959 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/hoge.yml
08:20:45.966496 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name '/Users/haratodaisuke/Dropbox/working/dbt/dbt_training/tests/generic/test.sql' in the 'models' section of file 'models/hoge.yml'
08:20:46.007045 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_/Users/haratodaisuke/Dropbox/working/dbt/dbt_training/tests/generic/test.sql_employee_id.b43db44dec' (models/hoge.yml) depends on a node named '/Users/haratodaisuke/Dropbox/working/dbt/dbt_training/tests/generic/test.sql' which was not found
08:20:46.018311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9402af49-f518-4ca4-a333-c828cfa222fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8485310>]}
08:20:46.024598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9402af49-f518-4ca4-a333-c828cfa222fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8c600d0>]}
08:20:46.025042 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:20:46.025399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9402af49-f518-4ca4-a333-c828cfa222fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8c60550>]}
08:20:46.026732 [info ] [MainThread]: 
08:20:46.027292 [debug] [MainThread]: Acquiring new postgres connection "master"
08:20:46.028110 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:20:46.041031 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:20:46.041340 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:20:46.041530 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:20:46.086111 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
08:20:46.086385 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:20:46.086574 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:20:46.089557 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:20:46.091023 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:20:46.091326 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:20:46.095850 [debug] [MainThread]: Using postgres connection "master"
08:20:46.096063 [debug] [MainThread]: On master: BEGIN
08:20:46.096230 [debug] [MainThread]: Opening a new connection, currently in state init
08:20:46.104391 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:20:46.104635 [debug] [MainThread]: Using postgres connection "master"
08:20:46.104810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:20:46.112190 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:20:46.113328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9402af49-f518-4ca4-a333-c828cfa222fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8c3f9d0>]}
08:20:46.113628 [debug] [MainThread]: On master: ROLLBACK
08:20:46.113904 [debug] [MainThread]: Using postgres connection "master"
08:20:46.114079 [debug] [MainThread]: On master: BEGIN
08:20:46.114404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:20:46.114601 [debug] [MainThread]: On master: COMMIT
08:20:46.114775 [debug] [MainThread]: Using postgres connection "master"
08:20:46.114934 [debug] [MainThread]: On master: COMMIT
08:20:46.115208 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:20:46.115418 [debug] [MainThread]: On master: Close
08:20:46.115775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:20:46.116095 [info ] [MainThread]: 
08:20:46.118169 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:20:46.118411 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:20:46.118920 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:20:46.119113 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:20:46.119296 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:20:46.120682 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:20:46.121531 [debug] [Thread-1  ]: finished collecting timing info
08:20:46.121767 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:20:46.142807 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:20:46.152009 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:20:46.152335 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:20:46.152565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:20:46.162120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:20:46.176748 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:20:46.177025 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
08:20:46.178392 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:20:46.180692 [debug] [Thread-1  ]: finished collecting timing info
08:20:46.180932 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:20:46.181233 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:20:46.181669 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.06s]
08:20:46.182171 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:20:46.221852 [debug] [MainThread]: Acquiring new postgres connection "master"
08:20:46.222223 [debug] [MainThread]: Using postgres connection "master"
08:20:46.222465 [debug] [MainThread]: On master: BEGIN
08:20:46.222685 [debug] [MainThread]: Opening a new connection, currently in state closed
08:20:46.232548 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:20:46.246759 [debug] [MainThread]: On master: COMMIT
08:20:46.247622 [debug] [MainThread]: Using postgres connection "master"
08:20:46.247850 [debug] [MainThread]: On master: COMMIT
08:20:46.248221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:20:46.248472 [debug] [MainThread]: On master: Close
08:20:46.248910 [info ] [MainThread]: 
08:20:46.249266 [info ] [MainThread]: Finished running 1 test in 0.22s.
08:20:46.249601 [debug] [MainThread]: Connection 'master' was properly closed.
08:20:46.268240 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:20:46.276642 [info ] [MainThread]: 
08:20:46.277092 [info ] [MainThread]: [32mCompleted successfully[0m
08:20:46.277501 [info ] [MainThread]: 
08:20:46.277838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:20:46.278250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc89fb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8e93d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc8e93090>]}


============================== 2022-05-19 08:21:12.567084 | 00bc6bc0-2824-4242-b56c-54ed937405e8 ==============================
08:21:12.567105 [info ] [MainThread]: Running with dbt=1.1.0
08:21:12.568294 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:21:12.568514 [debug] [MainThread]: Tracking: tracking
08:21:12.587570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572bd8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572bd8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572bd8050>]}
08:21:12.635344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:21:12.635910 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/hoge.yml
08:21:12.673073 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'generic/test.sql' in the 'models' section of file 'models/hoge.yml'
08:21:12.712124 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_generic/test.sql_employee_id.34605855dc' (models/hoge.yml) depends on a node named 'generic/test.sql' which was not found
08:21:12.722510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00bc6bc0-2824-4242-b56c-54ed937405e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572bc10d0>]}
08:21:12.728231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00bc6bc0-2824-4242-b56c-54ed937405e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572c36ad0>]}
08:21:12.728612 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:21:12.729009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00bc6bc0-2824-4242-b56c-54ed937405e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572c36990>]}
08:21:12.730351 [info ] [MainThread]: 
08:21:12.730939 [debug] [MainThread]: Acquiring new postgres connection "master"
08:21:12.731785 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:21:12.744895 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:21:12.745158 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:21:12.745344 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:21:12.787020 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
08:21:12.787290 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:21:12.787475 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:21:12.791073 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:21:12.792621 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:21:12.792940 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:21:12.797613 [debug] [MainThread]: Using postgres connection "master"
08:21:12.797826 [debug] [MainThread]: On master: BEGIN
08:21:12.797998 [debug] [MainThread]: Opening a new connection, currently in state init
08:21:12.806282 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:21:12.806518 [debug] [MainThread]: Using postgres connection "master"
08:21:12.806713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:21:12.814201 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:21:12.815335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00bc6bc0-2824-4242-b56c-54ed937405e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572c54690>]}
08:21:12.815640 [debug] [MainThread]: On master: ROLLBACK
08:21:12.815915 [debug] [MainThread]: Using postgres connection "master"
08:21:12.816090 [debug] [MainThread]: On master: BEGIN
08:21:12.816416 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:21:12.816620 [debug] [MainThread]: On master: COMMIT
08:21:12.816792 [debug] [MainThread]: Using postgres connection "master"
08:21:12.816952 [debug] [MainThread]: On master: COMMIT
08:21:12.817207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:21:12.817394 [debug] [MainThread]: On master: Close
08:21:12.817738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:21:12.818056 [info ] [MainThread]: 
08:21:12.820272 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:21:12.820544 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:21:12.821062 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:21:12.821261 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:21:12.821444 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:21:12.822828 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:21:12.823351 [debug] [Thread-1  ]: finished collecting timing info
08:21:12.823572 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:21:12.845591 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:21:12.854231 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:21:12.854547 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:21:12.854777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:21:12.864677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:21:12.878479 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:21:12.878809 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
08:21:12.880238 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:21:12.882493 [debug] [Thread-1  ]: finished collecting timing info
08:21:12.882734 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:21:12.883039 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:21:12.883486 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.06s]
08:21:12.883992 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:21:12.923623 [debug] [MainThread]: Acquiring new postgres connection "master"
08:21:12.923984 [debug] [MainThread]: Using postgres connection "master"
08:21:12.924222 [debug] [MainThread]: On master: BEGIN
08:21:12.924501 [debug] [MainThread]: Opening a new connection, currently in state closed
08:21:12.933790 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:21:12.934141 [debug] [MainThread]: On master: COMMIT
08:21:12.953444 [debug] [MainThread]: Using postgres connection "master"
08:21:12.954628 [debug] [MainThread]: On master: COMMIT
08:21:12.955250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:21:12.955647 [debug] [MainThread]: On master: Close
08:21:12.956245 [info ] [MainThread]: 
08:21:12.956615 [info ] [MainThread]: Finished running 1 test in 0.23s.
08:21:12.956955 [debug] [MainThread]: Connection 'master' was properly closed.
08:21:12.957134 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:21:12.976988 [info ] [MainThread]: 
08:21:12.977531 [info ] [MainThread]: [32mCompleted successfully[0m
08:21:12.977999 [info ] [MainThread]: 
08:21:12.978386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:21:12.978856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572e8e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572e8e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd572e8ea10>]}


============================== 2022-05-19 08:21:55.728721 | 1f42f3f4-5ec9-4ac2-923e-024718f16f7e ==============================
08:21:55.728755 [info ] [MainThread]: Running with dbt=1.1.0
08:21:55.729451 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:21:55.729627 [debug] [MainThread]: Tracking: tracking
08:21:55.745317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc02e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc02110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc02150>]}
08:21:55.782658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:21:55.783151 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/hoge.yml
08:21:55.821778 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hoge' in the 'models' section of file 'models/hoge.yml'
08:21:55.875279 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_training.my_not_null_hoge_employee_id.0925f85622' (models/hoge.yml) depends on a node named 'hoge' which was not found
08:21:55.886061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f42f3f4-5ec9-4ac2-923e-024718f16f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9c6fd4d0>]}
08:21:55.891373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f42f3f4-5ec9-4ac2-923e-024718f16f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc61890>]}
08:21:55.891729 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:21:55.892078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f42f3f4-5ec9-4ac2-923e-024718f16f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc61fd0>]}
08:21:55.893423 [info ] [MainThread]: 
08:21:55.894000 [debug] [MainThread]: Acquiring new postgres connection "master"
08:21:55.894814 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:21:55.907205 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:21:55.907467 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:21:55.907649 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:21:55.928936 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:21:55.929204 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:21:55.929388 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:21:55.932320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:21:55.933750 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:21:55.934069 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:21:55.938803 [debug] [MainThread]: Using postgres connection "master"
08:21:55.939055 [debug] [MainThread]: On master: BEGIN
08:21:55.939223 [debug] [MainThread]: Opening a new connection, currently in state init
08:21:55.947599 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:21:55.947847 [debug] [MainThread]: Using postgres connection "master"
08:21:55.948023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:21:55.955652 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:21:55.956874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f42f3f4-5ec9-4ac2-923e-024718f16f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc6f350>]}
08:21:55.957184 [debug] [MainThread]: On master: ROLLBACK
08:21:55.957508 [debug] [MainThread]: Using postgres connection "master"
08:21:55.957712 [debug] [MainThread]: On master: BEGIN
08:21:55.958103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:21:55.958312 [debug] [MainThread]: On master: COMMIT
08:21:55.958498 [debug] [MainThread]: Using postgres connection "master"
08:21:55.958671 [debug] [MainThread]: On master: COMMIT
08:21:55.959065 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:21:55.959337 [debug] [MainThread]: On master: Close
08:21:55.959722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:21:55.960044 [info ] [MainThread]: 
08:21:55.961759 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:21:55.961988 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:21:55.962489 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:21:55.962687 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:21:55.962870 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:21:55.964239 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:21:55.964741 [debug] [Thread-1  ]: finished collecting timing info
08:21:55.964954 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:21:55.986182 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:21:55.986781 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:21:55.986973 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:21:55.987134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:21:55.996500 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:21:55.996750 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:21:55.996935 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
08:21:55.998137 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:21:56.019955 [debug] [Thread-1  ]: finished collecting timing info
08:21:56.020241 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:21:56.020586 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:21:56.021031 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.06s]
08:21:56.021510 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:21:56.062028 [debug] [MainThread]: Acquiring new postgres connection "master"
08:21:56.066090 [debug] [MainThread]: Using postgres connection "master"
08:21:56.066771 [debug] [MainThread]: On master: BEGIN
08:21:56.067060 [debug] [MainThread]: Opening a new connection, currently in state closed
08:21:56.077018 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:21:56.077302 [debug] [MainThread]: On master: COMMIT
08:21:56.077590 [debug] [MainThread]: Using postgres connection "master"
08:21:56.077810 [debug] [MainThread]: On master: COMMIT
08:21:56.078106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:21:56.078360 [debug] [MainThread]: On master: Close
08:21:56.078810 [info ] [MainThread]: 
08:21:56.079168 [info ] [MainThread]: Finished running 1 test in 0.18s.
08:21:56.079484 [debug] [MainThread]: Connection 'master' was properly closed.
08:21:56.079650 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:21:56.085202 [info ] [MainThread]: 
08:21:56.085612 [info ] [MainThread]: [32mCompleted successfully[0m
08:21:56.085997 [info ] [MainThread]: 
08:21:56.086312 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:21:56.086705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9cc2d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9ceba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9ceba710>]}


============================== 2022-05-19 08:22:35.210702 | c79ee043-9b53-4cf6-83eb-7a2ab79fb217 ==============================
08:22:35.210751 [info ] [MainThread]: Running with dbt=1.1.0
08:22:35.212225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:22:35.212432 [debug] [MainThread]: Tracking: tracking
08:22:35.229829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207506150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207520650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2075209d0>]}
08:22:35.276579 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
08:22:35.276918 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://tests/generic/test.sql
08:22:35.277283 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
08:22:35.346147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c79ee043-9b53-4cf6-83eb-7a2ab79fb217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2073d1e90>]}
08:22:35.350975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c79ee043-9b53-4cf6-83eb-7a2ab79fb217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207554710>]}
08:22:35.351297 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:22:35.351631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79ee043-9b53-4cf6-83eb-7a2ab79fb217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207554f10>]}
08:22:35.352777 [info ] [MainThread]: 
08:22:35.353272 [debug] [MainThread]: Acquiring new postgres connection "master"
08:22:35.354031 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:22:35.366746 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:22:35.367008 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:22:35.367192 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:22:35.413303 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
08:22:35.419981 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:22:35.420373 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:22:35.423666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:22:35.425250 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:22:35.443582 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:22:35.449450 [debug] [MainThread]: Using postgres connection "master"
08:22:35.449758 [debug] [MainThread]: On master: BEGIN
08:22:35.449963 [debug] [MainThread]: Opening a new connection, currently in state init
08:22:35.458846 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:22:35.459090 [debug] [MainThread]: Using postgres connection "master"
08:22:35.459285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:22:35.467560 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:22:35.468904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79ee043-9b53-4cf6-83eb-7a2ab79fb217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207554810>]}
08:22:35.469244 [debug] [MainThread]: On master: ROLLBACK
08:22:35.469567 [debug] [MainThread]: Using postgres connection "master"
08:22:35.469793 [debug] [MainThread]: On master: BEGIN
08:22:35.470188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:22:35.470410 [debug] [MainThread]: On master: COMMIT
08:22:35.470607 [debug] [MainThread]: Using postgres connection "master"
08:22:35.470790 [debug] [MainThread]: On master: COMMIT
08:22:35.471102 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:22:35.471339 [debug] [MainThread]: On master: Close
08:22:35.471741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:22:35.472113 [info ] [MainThread]: 
08:22:35.474304 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:22:35.474575 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:22:35.475154 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:22:35.475371 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:22:35.475576 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:22:35.477086 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:22:35.477801 [debug] [Thread-1  ]: finished collecting timing info
08:22:35.478036 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:22:35.501017 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:22:35.518828 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:22:35.519190 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:22:35.519464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:22:35.529652 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:22:35.529915 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:22:35.530101 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where ture
      
    ) dbt_internal_test
08:22:35.530678 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "ture" does not exist
LINE 9: where ture
              ^

08:22:35.530881 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:22:35.531257 [debug] [Thread-1  ]: finished collecting timing info
08:22:35.531462 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:22:35.531836 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  column "ture" does not exist
  LINE 9: where ture
                ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
08:22:35.532125 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.06s]
08:22:35.532597 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:22:35.577866 [debug] [MainThread]: Acquiring new postgres connection "master"
08:22:35.578271 [debug] [MainThread]: Using postgres connection "master"
08:22:35.578528 [debug] [MainThread]: On master: BEGIN
08:22:35.578828 [debug] [MainThread]: Opening a new connection, currently in state closed
08:22:35.588491 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:22:35.588769 [debug] [MainThread]: On master: COMMIT
08:22:35.588966 [debug] [MainThread]: Using postgres connection "master"
08:22:35.589146 [debug] [MainThread]: On master: COMMIT
08:22:35.589431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:22:35.589660 [debug] [MainThread]: On master: Close
08:22:35.590071 [info ] [MainThread]: 
08:22:35.590418 [info ] [MainThread]: Finished running 1 test in 0.24s.
08:22:35.590744 [debug] [MainThread]: Connection 'master' was properly closed.
08:22:35.590920 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:22:35.596850 [info ] [MainThread]: 
08:22:35.597248 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:22:35.597620 [info ] [MainThread]: 
08:22:35.597948 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
08:22:35.598265 [error] [MainThread]:   column "ture" does not exist
08:22:35.598569 [error] [MainThread]:   LINE 9: where ture
08:22:35.598868 [error] [MainThread]:                 ^
08:22:35.599243 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
08:22:35.599688 [info ] [MainThread]: 
08:22:35.619140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:22:35.619704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2074c9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207517dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd207517d10>]}


============================== 2022-05-19 08:22:49.531295 | a4c82eac-037c-47ff-9e24-6241629696cc ==============================
08:22:49.531384 [info ] [MainThread]: Running with dbt=1.1.0
08:22:49.533001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:22:49.533204 [debug] [MainThread]: Tracking: tracking
08:22:49.549565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1493d0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1492edd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14933d490>]}
08:22:49.593627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:22:49.594117 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
08:22:49.664107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4c82eac-037c-47ff-9e24-6241629696cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1493dca90>]}
08:22:49.669245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4c82eac-037c-47ff-9e24-6241629696cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14944ad10>]}
08:22:49.669564 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:22:49.669898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c82eac-037c-47ff-9e24-6241629696cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14944ab50>]}
08:22:49.671051 [info ] [MainThread]: 
08:22:49.671548 [debug] [MainThread]: Acquiring new postgres connection "master"
08:22:49.672307 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:22:49.684675 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:22:49.684904 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:22:49.685065 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:22:49.714310 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
08:22:49.714563 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:22:49.714735 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:22:49.717716 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:22:49.719189 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:22:49.719488 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:22:49.724105 [debug] [MainThread]: Using postgres connection "master"
08:22:49.724305 [debug] [MainThread]: On master: BEGIN
08:22:49.724467 [debug] [MainThread]: Opening a new connection, currently in state init
08:22:49.733056 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:22:49.733411 [debug] [MainThread]: Using postgres connection "master"
08:22:49.733690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:22:49.742681 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:22:49.743965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c82eac-037c-47ff-9e24-6241629696cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149459650>]}
08:22:49.744303 [debug] [MainThread]: On master: ROLLBACK
08:22:49.744642 [debug] [MainThread]: Using postgres connection "master"
08:22:49.744846 [debug] [MainThread]: On master: BEGIN
08:22:49.745277 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:22:49.745485 [debug] [MainThread]: On master: COMMIT
08:22:49.745667 [debug] [MainThread]: Using postgres connection "master"
08:22:49.745834 [debug] [MainThread]: On master: COMMIT
08:22:49.746184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:22:49.746378 [debug] [MainThread]: On master: Close
08:22:49.746750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:22:49.747078 [info ] [MainThread]: 
08:22:49.749224 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:22:49.749448 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:22:49.749936 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:22:49.750122 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:22:49.750295 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:22:49.751625 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:22:49.752196 [debug] [Thread-1  ]: finished collecting timing info
08:22:49.752391 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:22:49.773162 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:22:49.773840 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:22:49.774047 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:22:49.774210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:22:49.783792 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:22:49.797123 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:22:49.797595 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where true
      
    ) dbt_internal_test
08:22:49.798935 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:22:49.801101 [debug] [Thread-1  ]: finished collecting timing info
08:22:49.801335 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:22:49.801630 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:22:49.802063 [error] [Thread-1  ]: 1 of 1 FAIL 2 always_fail_test ................................................. [[31mFAIL 2[0m in 0.05s]
08:22:49.821787 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:22:49.852360 [debug] [MainThread]: Acquiring new postgres connection "master"
08:22:49.852716 [debug] [MainThread]: Using postgres connection "master"
08:22:49.852955 [debug] [MainThread]: On master: BEGIN
08:22:49.853584 [debug] [MainThread]: Opening a new connection, currently in state closed
08:22:49.863212 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:22:49.863494 [debug] [MainThread]: On master: COMMIT
08:22:49.863683 [debug] [MainThread]: Using postgres connection "master"
08:22:49.863877 [debug] [MainThread]: On master: COMMIT
08:22:49.864218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:22:49.864452 [debug] [MainThread]: On master: Close
08:22:49.864869 [info ] [MainThread]: 
08:22:49.865218 [info ] [MainThread]: Finished running 1 test in 0.19s.
08:22:49.865538 [debug] [MainThread]: Connection 'master' was properly closed.
08:22:49.865707 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:22:49.871387 [info ] [MainThread]: 
08:22:49.871773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:22:49.872141 [info ] [MainThread]: 
08:22:49.872456 [error] [MainThread]: [31mFailure in test always_fail_test (tests/always_fail_test.sql)[0m
08:22:49.872774 [error] [MainThread]:   Got 2 results, configured to fail if != 0
08:22:49.873074 [info ] [MainThread]: 
08:22:49.873375 [info ] [MainThread]:   compiled SQL at target/compiled/dbt_training/tests/always_fail_test.sql
08:22:49.873783 [info ] [MainThread]: 
08:22:49.874121 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:22:49.874577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1492d2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149564a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149564cd0>]}


============================== 2022-05-19 08:23:10.182521 | 8f74bc7a-7e2c-4126-8d89-7b267ce0c20c ==============================
08:23:10.182594 [info ] [MainThread]: Running with dbt=1.1.0
08:23:10.183705 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'store_failures': True, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:23:10.183937 [debug] [MainThread]: Tracking: tracking
08:23:10.200342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abbecf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abbece50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abbec390>]}
08:23:10.247078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:23:10.247324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:23:10.254904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f74bc7a-7e2c-4126-8d89-7b267ce0c20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abe113d0>]}
08:23:10.260039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f74bc7a-7e2c-4126-8d89-7b267ce0c20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abd4c710>]}
08:23:10.260397 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:23:10.260744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f74bc7a-7e2c-4126-8d89-7b267ce0c20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abb51210>]}
08:23:10.262170 [info ] [MainThread]: 
08:23:10.262696 [debug] [MainThread]: Acquiring new postgres connection "master"
08:23:10.263498 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
08:23:10.306776 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
08:23:10.307070 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
08:23:10.307275 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:23:10.349942 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
08:23:10.351411 [debug] [ThreadPool]: On list_dbt_training: Close
08:23:10.352092 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_training_public_dbt_test__audit"
08:23:10.352426 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_training_public_dbt_test__audit"
08:23:10.352662 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_training', schema='public_dbt_test__audit', identifier=None)"
08:23:10.358751 [debug] [ThreadPool]: Using postgres connection "create_dbt_training_public_dbt_test__audit"
08:23:10.358950 [debug] [ThreadPool]: On create_dbt_training_public_dbt_test__audit: BEGIN
08:23:10.359113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:23:10.368080 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:23:10.368326 [debug] [ThreadPool]: Using postgres connection "create_dbt_training_public_dbt_test__audit"
08:23:10.368493 [debug] [ThreadPool]: On create_dbt_training_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "create_dbt_training_public_dbt_test__audit"} */
create schema if not exists "public_dbt_test__audit"
08:23:10.369148 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
08:23:10.370014 [debug] [ThreadPool]: On create_dbt_training_public_dbt_test__audit: COMMIT
08:23:10.370199 [debug] [ThreadPool]: Using postgres connection "create_dbt_training_public_dbt_test__audit"
08:23:10.370363 [debug] [ThreadPool]: On create_dbt_training_public_dbt_test__audit: COMMIT
08:23:10.370854 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
08:23:10.371075 [debug] [ThreadPool]: On create_dbt_training_public_dbt_test__audit: Close
08:23:10.372186 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public_dbt_test__audit"
08:23:10.378870 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public_dbt_test__audit"
08:23:10.379070 [debug] [ThreadPool]: On list_dbt_training_public_dbt_test__audit: BEGIN
08:23:10.379229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:23:10.387899 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:23:10.388128 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public_dbt_test__audit"
08:23:10.388294 [debug] [ThreadPool]: On list_dbt_training_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public_dbt_test__audit"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
  
08:23:10.391265 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
08:23:10.392463 [debug] [ThreadPool]: On list_dbt_training_public_dbt_test__audit: ROLLBACK
08:23:10.392790 [debug] [ThreadPool]: On list_dbt_training_public_dbt_test__audit: Close
08:23:10.393356 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:23:10.395175 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:23:10.395412 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:23:10.395599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:23:10.403723 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:23:10.403950 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:23:10.404118 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:23:10.407262 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:23:10.408545 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:23:10.408828 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:23:10.413304 [debug] [MainThread]: Using postgres connection "master"
08:23:10.413508 [debug] [MainThread]: On master: BEGIN
08:23:10.413669 [debug] [MainThread]: Opening a new connection, currently in state init
08:23:10.422350 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:23:10.422562 [debug] [MainThread]: Using postgres connection "master"
08:23:10.422731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:23:10.431961 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:23:10.433760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f74bc7a-7e2c-4126-8d89-7b267ce0c20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ab5e37d0>]}
08:23:10.434157 [debug] [MainThread]: On master: ROLLBACK
08:23:10.434562 [debug] [MainThread]: Using postgres connection "master"
08:23:10.434820 [debug] [MainThread]: On master: BEGIN
08:23:10.435316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:23:10.435586 [debug] [MainThread]: On master: COMMIT
08:23:10.435819 [debug] [MainThread]: Using postgres connection "master"
08:23:10.436039 [debug] [MainThread]: On master: COMMIT
08:23:10.436444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:23:10.436699 [debug] [MainThread]: On master: Close
08:23:10.437162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:23:10.437598 [info ] [MainThread]: 
08:23:10.439724 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:23:10.439979 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
08:23:10.440520 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:23:10.440727 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:23:10.440918 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:23:10.442607 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:23:10.443184 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.443423 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:23:10.465675 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:23:10.465909 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:23:10.466073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:23:10.475838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:23:10.476099 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:23:10.476273 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */

        

  create  table "dbt_training"."public_dbt_test__audit"."always_fail_test"
  as (
    select employee_id
from "dbt_training"."raw"."employees"
where true
  );
    
08:23:10.502809 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
08:23:10.540028 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: COMMIT
08:23:10.540384 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:23:10.540665 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: COMMIT
08:23:10.541501 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:23:10.548261 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
08:23:10.548995 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:23:10.549213 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
08:23:10.549793 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:23:10.550053 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
08:23:10.550258 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_training"."public_dbt_test__audit"."always_fail_test"
    
      
    ) dbt_internal_test
08:23:10.551058 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
08:23:10.553354 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.553593 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
08:23:10.553998 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
08:23:10.554472 [error] [Thread-1  ]: 1 of 1 FAIL 2 always_fail_test ................................................. [[31mFAIL 2[0m in 0.11s]
08:23:10.555019 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:23:10.653773 [debug] [MainThread]: Acquiring new postgres connection "master"
08:23:10.654398 [debug] [MainThread]: Using postgres connection "master"
08:23:10.654690 [debug] [MainThread]: On master: BEGIN
08:23:10.654968 [debug] [MainThread]: Opening a new connection, currently in state closed
08:23:10.666566 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:23:10.666837 [debug] [MainThread]: On master: COMMIT
08:23:10.667036 [debug] [MainThread]: Using postgres connection "master"
08:23:10.667223 [debug] [MainThread]: On master: COMMIT
08:23:10.667546 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:23:10.667793 [debug] [MainThread]: On master: Close
08:23:10.668201 [info ] [MainThread]: 
08:23:10.668553 [info ] [MainThread]: Finished running 1 test in 0.41s.
08:23:10.668880 [debug] [MainThread]: Connection 'master' was properly closed.
08:23:10.669048 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:23:10.674088 [info ] [MainThread]: 
08:23:10.674482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:23:10.674845 [info ] [MainThread]: 
08:23:10.675173 [error] [MainThread]: [31mFailure in test always_fail_test (tests/always_fail_test.sql)[0m
08:23:10.675490 [error] [MainThread]:   Got 2 results, configured to fail if != 0
08:23:10.675792 [info ] [MainThread]: 
08:23:10.676094 [info ] [MainThread]:   compiled SQL at target/compiled/dbt_training/tests/always_fail_test.sql
08:23:10.676405 [info ] [MainThread]: 
08:23:10.676707 [info ] [MainThread]:   See test failures:
  ------------------------------------------------------------------------
  select * from "dbt_training"."public_dbt_test__audit"."always_fail_test"
  ------------------------------------------------------------------------
08:23:10.677014 [info ] [MainThread]: 
08:23:10.677309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:23:10.677785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abd0ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abe5d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3abe5d290>]}


============================== 2022-05-19 08:25:17.951889 | 5cab42e4-8816-4cf0-9106-3d3534d43b92 ==============================
08:25:17.951930 [info ] [MainThread]: Running with dbt=1.1.0
08:25:17.954385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
08:25:17.954592 [debug] [MainThread]: Tracking: tracking
08:25:17.973707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f463f9e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f462c51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f463c2110>]}
08:25:18.029231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:25:18.029469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:25:18.038032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cab42e4-8816-4cf0-9106-3d3534d43b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45fdd610>]}
08:25:18.044382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cab42e4-8816-4cf0-9106-3d3534d43b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f46413090>]}
08:25:18.044735 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:25:18.045080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cab42e4-8816-4cf0-9106-3d3534d43b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f46413210>]}
08:25:18.046502 [info ] [MainThread]: 
08:25:18.047062 [debug] [MainThread]: Acquiring new postgres connection "master"
08:25:18.047807 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
08:25:18.090477 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:25:18.090757 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
08:25:18.090949 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:25:18.152989 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
08:25:18.153243 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
08:25:18.153413 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:25:18.156391 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
08:25:18.158804 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
08:25:18.159217 [debug] [ThreadPool]: On list_dbt_training_public: Close
08:25:18.164017 [debug] [MainThread]: Using postgres connection "master"
08:25:18.165027 [debug] [MainThread]: On master: BEGIN
08:25:18.165253 [debug] [MainThread]: Opening a new connection, currently in state init
08:25:18.173248 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:25:18.184810 [debug] [MainThread]: Using postgres connection "master"
08:25:18.185210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:25:18.195305 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:25:18.209393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cab42e4-8816-4cf0-9106-3d3534d43b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f4638c310>]}
08:25:18.209936 [debug] [MainThread]: On master: ROLLBACK
08:25:18.210463 [debug] [MainThread]: On master: Close
08:25:18.211019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:25:18.211440 [info ] [MainThread]: 
08:25:18.213868 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
08:25:18.214398 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
08:25:18.214665 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
08:25:18.214906 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
08:25:18.227658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
08:25:18.229237 [debug] [Thread-1  ]: finished collecting timing info
08:25:18.229468 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
08:25:18.229676 [debug] [Thread-1  ]: finished collecting timing info
08:25:18.230164 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
08:25:18.230411 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
08:25:18.230902 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
08:25:18.231112 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
08:25:18.231300 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
08:25:18.232746 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
08:25:18.233224 [debug] [Thread-1  ]: finished collecting timing info
08:25:18.233427 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
08:25:18.233618 [debug] [Thread-1  ]: finished collecting timing info
08:25:18.234209 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
08:25:18.316540 [debug] [MainThread]: Connection 'master' was properly closed.
08:25:18.317114 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
08:25:18.323797 [info ] [MainThread]: Done.
08:25:18.331668 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
08:25:18.331938 [info ] [MainThread]: Building catalog
08:25:18.333194 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_training.information_schema"
08:25:18.342246 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
08:25:18.342504 [debug] [ThreadPool]: On dbt_training.information_schema: BEGIN
08:25:18.342691 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:25:18.351901 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:25:18.352172 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
08:25:18.352360 [debug] [ThreadPool]: On dbt_training.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "dbt_training.information_schema"} */

    
    

    select
        'dbt_training' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
08:25:18.371200 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.02 seconds
08:25:18.390030 [debug] [ThreadPool]: On dbt_training.information_schema: ROLLBACK
08:25:18.390417 [debug] [ThreadPool]: On dbt_training.information_schema: Close
08:25:18.396486 [info ] [MainThread]: Catalog written to /Users/haratodaisuke/Dropbox/working/dbt/dbt_training/target/catalog.json
08:25:18.396969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f462c0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f463e62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f463c2750>]}
08:25:19.201057 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
08:25:19.205836 [debug] [MainThread]: Connection 'dbt_training.information_schema' was properly closed.


============================== 2022-05-19 08:26:32.496095 | 0ea39742-61b1-4f2c-82d7-e0392810ef31 ==============================
08:26:32.496136 [info ] [MainThread]: Running with dbt=1.1.0
08:26:32.497435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
08:26:32.497619 [debug] [MainThread]: Tracking: tracking
08:26:32.517745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bc01f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bc01410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bc013d0>]}
08:26:32.525340 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
08:26:32.525828 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
08:26:32.526127 [info ] [MainThread]: 
08:26:32.526412 [info ] [MainThread]: 
08:26:32.526682 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 08:27:34.641272 | 31480bcf-d7cd-4e05-90cc-08ba970c550b ==============================
08:27:34.641290 [info ] [MainThread]: Running with dbt=1.1.0
08:27:34.642048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
08:27:34.642272 [debug] [MainThread]: Tracking: tracking
08:27:34.656987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9f439dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9f402a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9f402390>]}
08:27:34.660641 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
08:27:34.661070 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
08:27:34.661364 [info ] [MainThread]: 
08:27:34.661630 [info ] [MainThread]: 
08:27:34.661892 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 14:32:15.583083 | 9f13ef8d-05e0-4d54-acd2-8e564807ea9e ==============================
14:32:15.583118 [info ] [MainThread]: Running with dbt=1.1.0
14:32:15.583829 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:32:15.584019 [debug] [MainThread]: Tracking: tracking
14:32:15.618487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb3f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb3f1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb3f1790>]}
14:32:15.672329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
14:32:15.672756 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.md
14:32:15.715326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f13ef8d-05e0-4d54-acd2-8e564807ea9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0baedd590>]}
14:32:15.725214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f13ef8d-05e0-4d54-acd2-8e564807ea9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb443d10>]}
14:32:15.725661 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:32:15.726072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f13ef8d-05e0-4d54-acd2-8e564807ea9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb443bd0>]}
14:32:15.727451 [info ] [MainThread]: 
14:32:15.728037 [debug] [MainThread]: Acquiring new postgres connection "master"
14:32:15.728792 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
14:32:15.742641 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:32:15.742896 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
14:32:15.743088 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:15.815761 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
14:32:15.818922 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:32:15.819252 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:32:15.825326 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
14:32:15.827207 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
14:32:15.827557 [debug] [ThreadPool]: On list_dbt_training_public: Close
14:32:15.832051 [debug] [MainThread]: Using postgres connection "master"
14:32:15.832276 [debug] [MainThread]: On master: BEGIN
14:32:15.832445 [debug] [MainThread]: Opening a new connection, currently in state init
14:32:15.840536 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:32:15.840799 [debug] [MainThread]: Using postgres connection "master"
14:32:15.840975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:32:15.852821 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:32:15.854224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f13ef8d-05e0-4d54-acd2-8e564807ea9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb4529d0>]}
14:32:15.854531 [debug] [MainThread]: On master: ROLLBACK
14:32:15.854817 [debug] [MainThread]: On master: Close
14:32:15.855173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:32:15.855494 [info ] [MainThread]: 
14:32:15.857558 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
14:32:15.857969 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
14:32:15.858168 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
14:32:15.858353 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
14:32:15.869460 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
14:32:15.870086 [debug] [Thread-1  ]: finished collecting timing info
14:32:15.870306 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
14:32:15.870496 [debug] [Thread-1  ]: finished collecting timing info
14:32:15.870959 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
14:32:15.871195 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
14:32:15.871522 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
14:32:15.871719 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
14:32:15.871889 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
14:32:15.873263 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
14:32:15.874104 [debug] [Thread-1  ]: finished collecting timing info
14:32:15.874311 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
14:32:15.874493 [debug] [Thread-1  ]: finished collecting timing info
14:32:15.874885 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
14:32:15.961575 [debug] [MainThread]: Connection 'master' was properly closed.
14:32:15.962185 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
14:32:15.969870 [info ] [MainThread]: Done.
14:32:15.978926 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
14:32:15.979213 [info ] [MainThread]: Building catalog
14:32:15.980480 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_training.information_schema"
14:32:15.990518 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:32:16.007733 [debug] [ThreadPool]: On dbt_training.information_schema: BEGIN
14:32:16.008384 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:32:16.018290 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:32:16.036443 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:32:16.036971 [debug] [ThreadPool]: On dbt_training.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "dbt_training.information_schema"} */

    
    

    select
        'dbt_training' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
14:32:16.044171 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
14:32:16.066356 [debug] [ThreadPool]: On dbt_training.information_schema: ROLLBACK
14:32:16.066756 [debug] [ThreadPool]: On dbt_training.information_schema: Close
14:32:16.072693 [info ] [MainThread]: Catalog written to /Users/haratodaisuke/Dropbox/working/dbt/dbt_training/target/catalog.json
14:32:16.073144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb3cb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb66f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb66f990>]}
14:32:16.769453 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:32:16.769812 [debug] [MainThread]: Connection 'dbt_training.information_schema' was properly closed.


============================== 2022-05-19 14:32:20.576262 | a97ffd67-a546-4a62-b966-4aa9b58e646b ==============================
14:32:20.576294 [info ] [MainThread]: Running with dbt=1.1.0
14:32:20.576954 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
14:32:20.577243 [debug] [MainThread]: Tracking: tracking
14:32:20.595128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80169e5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80169e5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80169e5450>]}
14:32:20.598860 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:32:20.599474 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:32:20.599774 [info ] [MainThread]: 
14:32:20.600042 [info ] [MainThread]: 
14:32:20.600308 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 14:34:04.822447 | 5f8f58fa-870b-4872-a06f-0af332661f14 ==============================
14:34:04.822472 [info ] [MainThread]: Running with dbt=1.1.0
14:34:04.823229 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:34:04.823399 [debug] [MainThread]: Tracking: tracking
14:34:04.839374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2d0de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d29f3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2ac0f50>]}
14:34:04.887868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:34:04.888359 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models/hoge.md
14:34:04.928547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f8f58fa-870b-4872-a06f-0af332661f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2e1a090>]}
14:34:04.934030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f8f58fa-870b-4872-a06f-0af332661f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2d55850>]}
14:34:04.934387 [info ] [MainThread]: Found 1 model, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:34:04.934770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8f58fa-870b-4872-a06f-0af332661f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2d55e50>]}
14:34:04.936098 [info ] [MainThread]: 
14:34:04.936658 [debug] [MainThread]: Acquiring new postgres connection "master"
14:34:04.937368 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
14:34:04.951259 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:34:04.951529 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
14:34:04.951724 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:34:04.984629 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
14:34:04.984886 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:34:04.985066 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:34:04.987945 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:34:04.989342 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
14:34:04.989649 [debug] [ThreadPool]: On list_dbt_training_public: Close
14:34:04.994186 [debug] [MainThread]: Using postgres connection "master"
14:34:04.994416 [debug] [MainThread]: On master: BEGIN
14:34:04.994591 [debug] [MainThread]: Opening a new connection, currently in state init
14:34:05.002663 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:34:05.002911 [debug] [MainThread]: Using postgres connection "master"
14:34:05.003102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:34:05.013525 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:34:05.043594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8f58fa-870b-4872-a06f-0af332661f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2d64b50>]}
14:34:05.060881 [debug] [MainThread]: On master: ROLLBACK
14:34:05.061421 [debug] [MainThread]: On master: Close
14:34:05.062094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:34:05.062649 [info ] [MainThread]: 
14:34:05.064530 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
14:34:05.064987 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
14:34:05.065217 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
14:34:05.065415 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
14:34:05.077273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
14:34:05.086076 [debug] [Thread-1  ]: finished collecting timing info
14:34:05.086418 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
14:34:05.086674 [debug] [Thread-1  ]: finished collecting timing info
14:34:05.087306 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
14:34:05.087618 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
14:34:05.088054 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
14:34:05.088412 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
14:34:05.088683 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
14:34:05.090514 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
14:34:05.091050 [debug] [Thread-1  ]: finished collecting timing info
14:34:05.091403 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
14:34:05.091612 [debug] [Thread-1  ]: finished collecting timing info
14:34:05.092089 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
14:34:05.167403 [debug] [MainThread]: Connection 'master' was properly closed.
14:34:05.167993 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
14:34:05.174210 [info ] [MainThread]: Done.
14:34:05.180207 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
14:34:05.180470 [info ] [MainThread]: Building catalog
14:34:05.181649 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_training.information_schema"
14:34:05.190902 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:34:05.191163 [debug] [ThreadPool]: On dbt_training.information_schema: BEGIN
14:34:05.191356 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:34:05.200654 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:34:05.200918 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:34:05.201108 [debug] [ThreadPool]: On dbt_training.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "dbt_training.information_schema"} */

    
    

    select
        'dbt_training' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
14:34:05.205415 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
14:34:05.213101 [debug] [ThreadPool]: On dbt_training.information_schema: ROLLBACK
14:34:05.231603 [debug] [ThreadPool]: On dbt_training.information_schema: Close
14:34:05.238396 [info ] [MainThread]: Catalog written to /Users/haratodaisuke/Dropbox/working/dbt/dbt_training/target/catalog.json
14:34:05.238866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2ad3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2ad3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2f94e10>]}
14:34:05.937540 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:34:05.937912 [debug] [MainThread]: Connection 'dbt_training.information_schema' was properly closed.


============================== 2022-05-19 14:34:09.630306 | a0c615cb-0c1d-4b04-a0cc-d97127e7a96d ==============================
14:34:09.630325 [info ] [MainThread]: Running with dbt=1.1.0
14:34:09.631172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
14:34:09.631363 [debug] [MainThread]: Tracking: tracking
14:34:09.648084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaffc08dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaffb56950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaffbedf10>]}
14:34:09.651911 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:34:09.652420 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:34:09.652722 [info ] [MainThread]: 
14:34:09.652994 [info ] [MainThread]: 
14:34:09.653262 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 14:42:06.567082 | 1dd10a4d-0005-412c-b7be-39230cc0730f ==============================
14:42:06.567101 [info ] [MainThread]: Running with dbt=1.1.0
14:42:06.567824 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:42:06.568074 [debug] [MainThread]: Tracking: tracking
14:42:06.584818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d43d6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d43d6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d43d61d0>]}
14:42:06.635388 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
14:42:06.635839 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/raw.yml
14:42:06.636114 [debug] [MainThread]: Partial parsing: added file: dbt_training://models/hoge.sql
14:42:06.636292 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
14:42:06.684691 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
14:42:06.730180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d4616f90>]}
14:42:06.735417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d4471650>]}
14:42:06.735766 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
14:42:06.736106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d43efbd0>]}
14:42:06.737382 [info ] [MainThread]: 
14:42:06.737897 [debug] [MainThread]: Acquiring new postgres connection "master"
14:42:06.738744 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
14:42:06.751491 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
14:42:06.751736 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
14:42:06.751908 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:42:06.778471 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.03 seconds
14:42:06.780001 [debug] [ThreadPool]: On list_dbt_training: Close
14:42:06.781026 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
14:42:06.787889 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:42:06.788109 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
14:42:06.788273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:42:06.796452 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:42:06.796698 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:42:06.796875 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:42:06.799875 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:42:06.801176 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
14:42:06.801473 [debug] [ThreadPool]: On list_dbt_training_public: Close
14:42:06.805854 [debug] [MainThread]: Using postgres connection "master"
14:42:06.806050 [debug] [MainThread]: On master: BEGIN
14:42:06.806210 [debug] [MainThread]: Opening a new connection, currently in state init
14:42:06.814035 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:42:06.814261 [debug] [MainThread]: Using postgres connection "master"
14:42:06.814431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:42:06.822701 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:42:06.823932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d466c350>]}
14:42:06.824258 [debug] [MainThread]: On master: ROLLBACK
14:42:06.824560 [debug] [MainThread]: Using postgres connection "master"
14:42:06.844152 [debug] [MainThread]: On master: BEGIN
14:42:06.845443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:42:06.845823 [debug] [MainThread]: On master: COMMIT
14:42:06.846124 [debug] [MainThread]: Using postgres connection "master"
14:42:06.846399 [debug] [MainThread]: On master: COMMIT
14:42:06.846880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:42:06.847241 [debug] [MainThread]: On master: Close
14:42:06.847849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:42:06.848213 [info ] [MainThread]: 
14:42:06.851471 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
14:42:06.869591 [info ] [Thread-1  ]: 1 of 2 START incremental model public.employee_names ........................... [RUN]
14:42:06.870832 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
14:42:06.871101 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
14:42:06.871348 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
14:42:06.883531 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
14:42:06.884282 [debug] [Thread-1  ]: finished collecting timing info
14:42:06.884518 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
14:42:06.940376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:06.941904 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

    

  create temporary table "employee_names__dbt_tmp234206922620"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"



	where "employee_id" not in (SELECT "employee_id" FROM "dbt_training"."public"."employee_names")


  );
  
14:42:06.942200 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:42:06.969098 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.03 seconds
14:42:06.978582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:06.978796 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
14:42:06.979161 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:42:06.979352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:06.979528 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'employee_names__dbt_tmp234206922620'
        
      order by ordinal_position

  
14:42:06.989788 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
14:42:06.995831 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:06.996042 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
14:42:06.998482 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
14:42:07.007317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:07.007536 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
14:42:07.009758 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
14:42:07.022799 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
14:42:07.024991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:07.025254 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

    insert into "dbt_training"."public"."employee_names" ("employee_id", "full_name")
    (
        select "employee_id", "full_name"
        from "employee_names__dbt_tmp234206922620"
    )
  
14:42:07.025780 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
14:42:07.033889 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
14:42:07.034101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
14:42:07.034267 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
14:42:07.034937 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:42:07.035551 [debug] [Thread-1  ]: finished collecting timing info
14:42:07.035770 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
14:42:07.036192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d46996d0>]}
14:42:07.036577 [info ] [Thread-1  ]: 1 of 2 OK created incremental model public.employee_names ...................... [[32mINSERT 0 0[0m in 0.17s]
14:42:07.037036 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
14:42:07.037265 [debug] [Thread-1  ]: Began running node model.dbt_training.hoge
14:42:07.037625 [info ] [Thread-1  ]: 2 of 2 START view model public.hoge ............................................ [RUN]
14:42:07.038123 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.hoge"
14:42:07.038314 [debug] [Thread-1  ]: Began compiling node model.dbt_training.hoge
14:42:07.038490 [debug] [Thread-1  ]: Compiling model.dbt_training.hoge
14:42:07.041272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.hoge"
14:42:07.042159 [debug] [Thread-1  ]: finished collecting timing info
14:42:07.067139 [debug] [Thread-1  ]: Began executing node model.dbt_training.hoge
14:42:07.088501 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.hoge"
14:42:07.089047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
14:42:07.089228 [debug] [Thread-1  ]: On model.dbt_training.hoge: BEGIN
14:42:07.089386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:42:07.097301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:42:07.097517 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
14:42:07.097682 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */

  create view "dbt_training"."public"."hoge__dbt_tmp" as (
    select
    *
from "dbt_training"."raw"."employees"
  );
14:42:07.100579 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:42:07.107244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
14:42:07.107423 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */
alter table "dbt_training"."public"."hoge__dbt_tmp" rename to "hoge"
14:42:07.107865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:42:07.109096 [debug] [Thread-1  ]: On model.dbt_training.hoge: COMMIT
14:42:07.109273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
14:42:07.109433 [debug] [Thread-1  ]: On model.dbt_training.hoge: COMMIT
14:42:07.109990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:42:07.115259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
14:42:07.115489 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */
drop view if exists "dbt_training"."public"."hoge__dbt_backup" cascade
14:42:07.115914 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:42:07.117026 [debug] [Thread-1  ]: finished collecting timing info
14:42:07.117232 [debug] [Thread-1  ]: On model.dbt_training.hoge: Close
14:42:07.117633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd10a4d-0005-412c-b7be-39230cc0730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d43b1850>]}
14:42:07.117997 [info ] [Thread-1  ]: 2 of 2 OK created view model public.hoge ....................................... [[32mCREATE VIEW[0m in 0.08s]
14:42:07.118437 [debug] [Thread-1  ]: Finished running node model.dbt_training.hoge
14:42:07.157212 [debug] [MainThread]: Acquiring new postgres connection "master"
14:42:07.157812 [debug] [MainThread]: Using postgres connection "master"
14:42:07.158100 [debug] [MainThread]: On master: BEGIN
14:42:07.158361 [debug] [MainThread]: Opening a new connection, currently in state closed
14:42:07.168331 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:42:07.183957 [debug] [MainThread]: On master: COMMIT
14:42:07.184837 [debug] [MainThread]: Using postgres connection "master"
14:42:07.185329 [debug] [MainThread]: On master: COMMIT
14:42:07.185840 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:42:07.186103 [debug] [MainThread]: On master: Close
14:42:07.186614 [info ] [MainThread]: 
14:42:07.186964 [info ] [MainThread]: Finished running 1 incremental model, 1 view model in 0.45s.
14:42:07.187293 [debug] [MainThread]: Connection 'master' was properly closed.
14:42:07.187470 [debug] [MainThread]: Connection 'model.dbt_training.hoge' was properly closed.
14:42:07.209124 [info ] [MainThread]: 
14:42:07.209612 [info ] [MainThread]: [32mCompleted successfully[0m
14:42:07.210097 [info ] [MainThread]: 
14:42:07.210484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:42:07.210906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d48ee690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d48ee150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d48ee110>]}


============================== 2022-05-19 14:42:35.022157 | 50a9a082-6b35-4e24-b5fc-2c80dbca8cf6 ==============================
14:42:35.022176 [info ] [MainThread]: Running with dbt=1.1.0
14:42:35.022985 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:42:35.023207 [debug] [MainThread]: Tracking: tracking
14:42:35.040213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff491402e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4911f2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff491402050>]}
14:42:35.086291 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
14:42:35.086577 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
14:42:35.126903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50a9a082-6b35-4e24-b5fc-2c80dbca8cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4912b1390>]}
14:42:35.132391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50a9a082-6b35-4e24-b5fc-2c80dbca8cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49146bd50>]}
14:42:35.132801 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
14:42:35.133190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a9a082-6b35-4e24-b5fc-2c80dbca8cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4914881d0>]}
14:42:35.134710 [info ] [MainThread]: 
14:42:35.135284 [debug] [MainThread]: Acquiring new postgres connection "master"
14:42:35.136049 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
14:42:35.149535 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:42:35.149809 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
14:42:35.150061 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:42:35.181130 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
14:42:35.181434 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
14:42:35.181634 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:42:35.186134 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
14:42:35.188084 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
14:42:35.188452 [debug] [ThreadPool]: On list_dbt_training_public: Close
14:42:35.193443 [debug] [MainThread]: Using postgres connection "master"
14:42:35.193660 [debug] [MainThread]: On master: BEGIN
14:42:35.193834 [debug] [MainThread]: Opening a new connection, currently in state init
14:42:35.202331 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:42:35.202567 [debug] [MainThread]: Using postgres connection "master"
14:42:35.202753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:42:35.211796 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
14:42:35.213167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a9a082-6b35-4e24-b5fc-2c80dbca8cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff491492310>]}
14:42:35.213459 [debug] [MainThread]: On master: ROLLBACK
14:42:35.213722 [debug] [MainThread]: On master: Close
14:42:35.214072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:42:35.214381 [info ] [MainThread]: 
14:42:35.216369 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
14:42:35.216785 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
14:42:35.216976 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
14:42:35.217161 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
14:42:35.227714 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
14:42:35.228189 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.228383 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
14:42:35.228563 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.228976 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
14:42:35.229191 [debug] [Thread-1  ]: Began running node model.dbt_training.hoge
14:42:35.229503 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.hoge"
14:42:35.229682 [debug] [Thread-1  ]: Began compiling node model.dbt_training.hoge
14:42:35.229854 [debug] [Thread-1  ]: Compiling model.dbt_training.hoge
14:42:35.233352 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.hoge"
14:42:35.233996 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.234226 [debug] [Thread-1  ]: Began executing node model.dbt_training.hoge
14:42:35.234419 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.234929 [debug] [Thread-1  ]: Finished running node model.dbt_training.hoge
14:42:35.235179 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
14:42:35.235626 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
14:42:35.235843 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
14:42:35.236027 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
14:42:35.237491 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
14:42:35.238384 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.238647 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
14:42:35.238834 [debug] [Thread-1  ]: finished collecting timing info
14:42:35.239264 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
14:42:35.320231 [debug] [MainThread]: Connection 'master' was properly closed.
14:42:35.320518 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
14:42:35.325980 [info ] [MainThread]: Done.
14:42:35.331658 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
14:42:35.331948 [info ] [MainThread]: Building catalog
14:42:35.333937 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_training.information_schema"
14:42:35.342140 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:42:35.354485 [debug] [ThreadPool]: On dbt_training.information_schema: BEGIN
14:42:35.354807 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:42:35.363998 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:42:35.378677 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
14:42:35.379100 [debug] [ThreadPool]: On dbt_training.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "dbt_training.information_schema"} */

    
    

    select
        'dbt_training' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('raw') or upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
14:42:35.391489 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.01 seconds
14:42:35.410570 [debug] [ThreadPool]: On dbt_training.information_schema: ROLLBACK
14:42:35.410968 [debug] [ThreadPool]: On dbt_training.information_schema: Close
14:42:35.418627 [info ] [MainThread]: Catalog written to /Users/haratodaisuke/Dropbox/working/dbt/dbt_training/target/catalog.json
14:42:35.419069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4912d0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4916b8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4916b8310>]}
14:42:36.158969 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:42:36.159341 [debug] [MainThread]: Connection 'dbt_training.information_schema' was properly closed.


============================== 2022-05-19 14:42:40.750921 | c4d0495e-3a01-4020-b6ea-fe048407898e ==============================
14:42:40.750941 [info ] [MainThread]: Running with dbt=1.1.0
14:42:40.751673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
14:42:40.751870 [debug] [MainThread]: Tracking: tracking
14:42:40.767169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a1b00e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59f046ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a1b00450>]}
14:42:40.770530 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:42:40.771028 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:42:40.771333 [info ] [MainThread]: 
14:42:40.771602 [info ] [MainThread]: 
14:42:40.771867 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 15:02:54.377103 | ad9bc1e5-6d26-4a0b-ad93-9766f2059ace ==============================
15:02:54.377120 [info ] [MainThread]: Running with dbt=1.1.0
15:02:54.377868 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:02:54.378096 [debug] [MainThread]: Tracking: tracking
15:02:54.402268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff5407e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff53e8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff53e8f90>]}
15:02:54.453031 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:02:54.453624 [debug] [MainThread]: Partial parsing: deleted source source.dbt_training.staging.employees
15:02:54.453805 [debug] [MainThread]: Partial parsing: deleted source source.dbt_training.staging.jobs
15:02:54.453995 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/raw.yml
15:02:54.454163 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:02:54.497644 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
15:02:54.546830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff53e1e90>]}
15:02:54.554036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff544c310>]}
15:02:54.554419 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:02:54.554774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff544c690>]}
15:02:54.556071 [info ] [MainThread]: 
15:02:54.556613 [debug] [MainThread]: Acquiring new postgres connection "master"
15:02:54.557442 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
15:02:54.569426 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
15:02:54.569664 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
15:02:54.569839 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:02:54.620481 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
15:02:54.622453 [debug] [ThreadPool]: On list_dbt_training: Close
15:02:54.623605 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:02:54.630435 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:02:54.630664 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:02:54.630835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:02:54.638869 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:02:54.639094 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:02:54.639274 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:02:54.642079 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:02:54.643414 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:02:54.643743 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:02:54.648239 [debug] [MainThread]: Using postgres connection "master"
15:02:54.648454 [debug] [MainThread]: On master: BEGIN
15:02:54.648623 [debug] [MainThread]: Opening a new connection, currently in state init
15:02:54.656558 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:02:54.656806 [debug] [MainThread]: Using postgres connection "master"
15:02:54.656981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:02:54.666338 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:02:54.667622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff5581f90>]}
15:02:54.667941 [debug] [MainThread]: On master: ROLLBACK
15:02:54.668243 [debug] [MainThread]: Using postgres connection "master"
15:02:54.668435 [debug] [MainThread]: On master: BEGIN
15:02:54.668806 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:02:54.669010 [debug] [MainThread]: On master: COMMIT
15:02:54.669191 [debug] [MainThread]: Using postgres connection "master"
15:02:54.669357 [debug] [MainThread]: On master: COMMIT
15:02:54.669639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:54.669853 [debug] [MainThread]: On master: Close
15:02:54.670211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:02:54.670534 [info ] [MainThread]: 
15:02:54.673441 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
15:02:54.673800 [info ] [Thread-1  ]: 1 of 2 START incremental model public.employee_names ........................... [RUN]
15:02:54.674339 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
15:02:54.674542 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
15:02:54.674736 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
15:02:54.686448 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
15:02:54.687041 [debug] [Thread-1  ]: finished collecting timing info
15:02:54.687307 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
15:02:54.751987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.752256 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

    

  create temporary table "employee_names__dbt_tmp000254729735"
  as (
    
select
	"employee_id",
	concat("first_name", ' ', "last_name") as full_name
from
	"dbt_training"."raw"."employees"



	where "employee_id" not in (SELECT "employee_id" FROM "dbt_training"."public"."employee_names")


  );
  
15:02:54.752464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:54.773401 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.02 seconds
15:02:54.783836 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.799753 [debug] [Thread-1  ]: On model.dbt_training.employee_names: BEGIN
15:02:54.800930 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:54.802049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.802378 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'employee_names__dbt_tmp000254729735'
        
      order by ordinal_position

  
15:02:54.811632 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
15:02:54.818208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.818453 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
15:02:54.821093 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:02:54.830769 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.847205 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_training".INFORMATION_SCHEMA.columns
      where table_name = 'employee_names'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
15:02:54.851760 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
15:02:54.866688 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.employee_names"
15:02:54.868419 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.868697 [debug] [Thread-1  ]: On model.dbt_training.employee_names: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.employee_names"} */

      

    insert into "dbt_training"."public"."employee_names" ("employee_id", "full_name")
    (
        select "employee_id", "full_name"
        from "employee_names__dbt_tmp000254729735"
    )
  
15:02:54.869307 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
15:02:54.877922 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
15:02:54.878127 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.employee_names"
15:02:54.878304 [debug] [Thread-1  ]: On model.dbt_training.employee_names: COMMIT
15:02:54.879014 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:54.879548 [debug] [Thread-1  ]: finished collecting timing info
15:02:54.879771 [debug] [Thread-1  ]: On model.dbt_training.employee_names: Close
15:02:54.880206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff55a59d0>]}
15:02:54.880611 [info ] [Thread-1  ]: 1 of 2 OK created incremental model public.employee_names ...................... [[32mINSERT 0 0[0m in 0.21s]
15:02:54.881102 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
15:02:54.881344 [debug] [Thread-1  ]: Began running node model.dbt_training.hoge
15:02:54.881723 [info ] [Thread-1  ]: 2 of 2 START view model public.hoge ............................................ [RUN]
15:02:54.882265 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.hoge"
15:02:54.882471 [debug] [Thread-1  ]: Began compiling node model.dbt_training.hoge
15:02:54.882663 [debug] [Thread-1  ]: Compiling model.dbt_training.hoge
15:02:54.885484 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.hoge"
15:02:54.907601 [debug] [Thread-1  ]: finished collecting timing info
15:02:54.908019 [debug] [Thread-1  ]: Began executing node model.dbt_training.hoge
15:02:54.931540 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_training.hoge"
15:02:54.932140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.932341 [debug] [Thread-1  ]: On model.dbt_training.hoge: BEGIN
15:02:54.932513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:54.940669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:02:54.940887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.941054 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */

  create view "dbt_training"."public"."hoge__dbt_tmp" as (
    select
    *
from "dbt_training"."raw"."employees"
  );
15:02:54.944425 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:54.951480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.951675 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */
alter table "dbt_training"."public"."hoge" rename to "hoge__dbt_backup"
15:02:54.952198 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:54.954501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.954684 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */
alter table "dbt_training"."public"."hoge__dbt_tmp" rename to "hoge"
15:02:54.955095 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:54.956327 [debug] [Thread-1  ]: On model.dbt_training.hoge: COMMIT
15:02:54.956513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.956681 [debug] [Thread-1  ]: On model.dbt_training.hoge: COMMIT
15:02:54.957275 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:54.963404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_training.hoge"
15:02:54.963598 [debug] [Thread-1  ]: On model.dbt_training.hoge: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "model.dbt_training.hoge"} */
drop view if exists "dbt_training"."public"."hoge__dbt_backup" cascade
15:02:54.965535 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:54.966810 [debug] [Thread-1  ]: finished collecting timing info
15:02:54.967036 [debug] [Thread-1  ]: On model.dbt_training.hoge: Close
15:02:54.967446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad9bc1e5-6d26-4a0b-ad93-9766f2059ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff57e7ed0>]}
15:02:54.967812 [info ] [Thread-1  ]: 2 of 2 OK created view model public.hoge ....................................... [[32mCREATE VIEW[0m in 0.09s]
15:02:54.968250 [debug] [Thread-1  ]: Finished running node model.dbt_training.hoge
15:02:54.990389 [debug] [MainThread]: Acquiring new postgres connection "master"
15:02:55.002267 [debug] [MainThread]: Using postgres connection "master"
15:02:55.002611 [debug] [MainThread]: On master: BEGIN
15:02:55.002843 [debug] [MainThread]: Opening a new connection, currently in state closed
15:02:55.012288 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:02:55.023666 [debug] [MainThread]: On master: COMMIT
15:02:55.023952 [debug] [MainThread]: Using postgres connection "master"
15:02:55.024195 [debug] [MainThread]: On master: COMMIT
15:02:55.024728 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:55.024983 [debug] [MainThread]: On master: Close
15:02:55.025467 [info ] [MainThread]: 
15:02:55.025835 [info ] [MainThread]: Finished running 1 incremental model, 1 view model in 0.47s.
15:02:55.026165 [debug] [MainThread]: Connection 'master' was properly closed.
15:02:55.026340 [debug] [MainThread]: Connection 'model.dbt_training.hoge' was properly closed.
15:02:55.031466 [info ] [MainThread]: 
15:02:55.031855 [info ] [MainThread]: [32mCompleted successfully[0m
15:02:55.032239 [info ] [MainThread]: 
15:02:55.032555 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:02:55.032953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff57e1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff57e1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff57e15d0>]}


============================== 2022-05-19 15:03:09.570932 | 515dbedd-4563-465f-a567-10a6672c8080 ==============================
15:03:09.570961 [info ] [MainThread]: Running with dbt=1.1.0
15:03:09.571662 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:03:09.571887 [debug] [MainThread]: Tracking: tracking
15:03:09.586188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008ae6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008ae6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008ae60d0>]}
15:03:09.622705 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
15:03:09.623023 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:03:09.662548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515dbedd-4563-465f-a567-10a6672c8080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008ab8090>]}
15:03:09.668273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '515dbedd-4563-465f-a567-10a6672c8080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008b506d0>]}
15:03:09.668658 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:03:09.669031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515dbedd-4563-465f-a567-10a6672c8080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008b50a90>]}
15:03:09.670389 [info ] [MainThread]: 
15:03:09.670965 [debug] [MainThread]: Acquiring new postgres connection "master"
15:03:09.671970 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:03:09.685928 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:03:09.686184 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:03:09.686368 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:03:09.697809 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:03:09.698066 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:03:09.698245 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:03:09.701338 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:03:09.702810 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:03:09.703108 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:03:09.707981 [debug] [MainThread]: Using postgres connection "master"
15:03:09.708251 [debug] [MainThread]: On master: BEGIN
15:03:09.708431 [debug] [MainThread]: Opening a new connection, currently in state init
15:03:09.717477 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:03:09.717736 [debug] [MainThread]: Using postgres connection "master"
15:03:09.717918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:03:09.727458 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:03:09.728896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515dbedd-4563-465f-a567-10a6672c8080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008b7ab50>]}
15:03:09.729218 [debug] [MainThread]: On master: ROLLBACK
15:03:09.729582 [debug] [MainThread]: Using postgres connection "master"
15:03:09.729786 [debug] [MainThread]: On master: BEGIN
15:03:09.730181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:03:09.730394 [debug] [MainThread]: On master: COMMIT
15:03:09.730575 [debug] [MainThread]: Using postgres connection "master"
15:03:09.730742 [debug] [MainThread]: On master: COMMIT
15:03:09.731022 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:03:09.731239 [debug] [MainThread]: On master: Close
15:03:09.731615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:03:09.731935 [info ] [MainThread]: 
15:03:09.733502 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:03:09.733746 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
15:03:09.734280 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:03:09.734479 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:03:09.734665 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:03:09.736237 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:03:09.737158 [debug] [Thread-1  ]: finished collecting timing info
15:03:09.737401 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:03:09.759151 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:03:09.760986 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:03:09.761220 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:03:09.761399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:03:09.770135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:03:09.806268 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:03:09.826220 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where true
      
    ) dbt_internal_test
15:03:09.839260 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
15:03:09.854645 [debug] [Thread-1  ]: finished collecting timing info
15:03:09.854921 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:03:09.855291 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:03:09.855792 [error] [Thread-1  ]: 1 of 1 FAIL 2 always_fail_test ................................................. [[31mFAIL 2[0m in 0.12s]
15:03:09.856605 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:03:09.938853 [debug] [MainThread]: Acquiring new postgres connection "master"
15:03:09.939240 [debug] [MainThread]: Using postgres connection "master"
15:03:09.939446 [debug] [MainThread]: On master: BEGIN
15:03:09.940109 [debug] [MainThread]: Opening a new connection, currently in state closed
15:03:09.981031 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:03:09.981332 [debug] [MainThread]: On master: COMMIT
15:03:09.981526 [debug] [MainThread]: Using postgres connection "master"
15:03:09.981704 [debug] [MainThread]: On master: COMMIT
15:03:09.982008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:03:09.982225 [debug] [MainThread]: On master: Close
15:03:09.982643 [info ] [MainThread]: 
15:03:09.982987 [info ] [MainThread]: Finished running 1 test in 0.31s.
15:03:09.983304 [debug] [MainThread]: Connection 'master' was properly closed.
15:03:09.983476 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
15:03:09.988982 [info ] [MainThread]: 
15:03:09.989378 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:03:09.989742 [info ] [MainThread]: 
15:03:09.990055 [error] [MainThread]: [31mFailure in test always_fail_test (tests/always_fail_test.sql)[0m
15:03:09.990373 [error] [MainThread]:   Got 2 results, configured to fail if != 0
15:03:09.990674 [info ] [MainThread]: 
15:03:09.990974 [info ] [MainThread]:   compiled SQL at target/compiled/dbt_training/tests/always_fail_test.sql
15:03:09.991279 [info ] [MainThread]: 
15:03:09.991571 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:03:09.991997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008b50d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008e89a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe008e89ed0>]}


============================== 2022-05-19 15:03:40.915033 | bee6646e-d391-4456-8165-e3c8ab7e450a ==============================
15:03:40.915090 [info ] [MainThread]: Running with dbt=1.1.0
15:03:40.916532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:03:40.916757 [debug] [MainThread]: Tracking: tracking
15:03:40.933817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf439f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf4393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf439490>]}
15:03:40.982249 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:03:40.982578 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:03:40.982989 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
15:03:41.054835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee6646e-d391-4456-8165-e3c8ab7e450a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf02dd90>]}
15:03:41.060621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee6646e-d391-4456-8165-e3c8ab7e450a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf45f110>]}
15:03:41.060965 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:03:41.061294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee6646e-d391-4456-8165-e3c8ab7e450a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf45f2d0>]}
15:03:41.062482 [info ] [MainThread]: 
15:03:41.062974 [debug] [MainThread]: Acquiring new postgres connection "master"
15:03:41.063795 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:03:41.075912 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:03:41.076224 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:03:41.076478 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:03:41.114311 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
15:03:41.114566 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:03:41.114740 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:03:41.118053 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:03:41.119661 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:03:41.119965 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:03:41.124529 [debug] [MainThread]: Using postgres connection "master"
15:03:41.124768 [debug] [MainThread]: On master: BEGIN
15:03:41.124938 [debug] [MainThread]: Opening a new connection, currently in state init
15:03:41.133031 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:03:41.133295 [debug] [MainThread]: Using postgres connection "master"
15:03:41.133479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:03:41.142575 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:03:41.143887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee6646e-d391-4456-8165-e3c8ab7e450a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf47a990>]}
15:03:41.144212 [debug] [MainThread]: On master: ROLLBACK
15:03:41.144535 [debug] [MainThread]: Using postgres connection "master"
15:03:41.144746 [debug] [MainThread]: On master: BEGIN
15:03:41.145087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:03:41.145275 [debug] [MainThread]: On master: COMMIT
15:03:41.145452 [debug] [MainThread]: Using postgres connection "master"
15:03:41.145616 [debug] [MainThread]: On master: COMMIT
15:03:41.145862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:03:41.146048 [debug] [MainThread]: On master: Close
15:03:41.146410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:03:41.146730 [info ] [MainThread]: 
15:03:41.150503 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:03:41.150759 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
15:03:41.151273 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:03:41.151502 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:03:41.151742 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:03:41.153315 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:03:41.153799 [debug] [Thread-1  ]: finished collecting timing info
15:03:41.154019 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:03:41.175690 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:03:41.179942 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:03:41.180177 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:03:41.180365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:03:41.189753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:03:41.194591 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:03:41.194864 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- select employee_id
-- from "dbt_training"."raw"."employees"
-- where true
      
    ) dbt_internal_test
15:03:41.196764 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 11:     ) dbt_internal_test
             ^

15:03:41.197002 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:03:41.197408 [debug] [Thread-1  ]: finished collecting timing info
15:03:41.197614 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:03:41.197993 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  syntax error at or near ")"
  LINE 11:     ) dbt_internal_test
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:03:41.198274 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.05s]
15:03:41.198859 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:03:41.255609 [debug] [MainThread]: Acquiring new postgres connection "master"
15:03:41.256185 [debug] [MainThread]: Using postgres connection "master"
15:03:41.256468 [debug] [MainThread]: On master: BEGIN
15:03:41.256732 [debug] [MainThread]: Opening a new connection, currently in state closed
15:03:41.267855 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:03:41.285165 [debug] [MainThread]: On master: COMMIT
15:03:41.286128 [debug] [MainThread]: Using postgres connection "master"
15:03:41.286480 [debug] [MainThread]: On master: COMMIT
15:03:41.287005 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:03:41.287334 [debug] [MainThread]: On master: Close
15:03:41.287934 [info ] [MainThread]: 
15:03:41.288449 [info ] [MainThread]: Finished running 1 test in 0.23s.
15:03:41.288877 [debug] [MainThread]: Connection 'master' was properly closed.
15:03:41.289080 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
15:03:41.310919 [info ] [MainThread]: 
15:03:41.311395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:03:41.311837 [info ] [MainThread]: 
15:03:41.312339 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
15:03:41.332305 [error] [MainThread]:   syntax error at or near ")"
15:03:41.332965 [error] [MainThread]:   LINE 11:     ) dbt_internal_test
15:03:41.351620 [error] [MainThread]:                ^
15:03:41.352112 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:03:41.352597 [info ] [MainThread]: 
15:03:41.353071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:03:41.353685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf68af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf402690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf402550>]}


============================== 2022-05-19 15:04:11.112994 | 0f1f3899-cc92-4d67-8816-02249c3de546 ==============================
15:04:11.113013 [info ] [MainThread]: Running with dbt=1.1.0
15:04:11.113777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:04:11.113995 [debug] [MainThread]: Tracking: tracking
15:04:11.129413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933ba9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933adc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933421b90>]}
15:04:11.165275 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
15:04:11.165542 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:04:11.203033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1f3899-cc92-4d67-8816-02249c3de546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933b9c250>]}
15:04:11.208270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1f3899-cc92-4d67-8816-02249c3de546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933c206d0>]}
15:04:11.208630 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:04:11.208994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1f3899-cc92-4d67-8816-02249c3de546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933c20a50>]}
15:04:11.210294 [info ] [MainThread]: 
15:04:11.210850 [debug] [MainThread]: Acquiring new postgres connection "master"
15:04:11.211769 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:04:11.225051 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:04:11.225311 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:04:11.225500 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:04:11.247928 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:04:11.248183 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:04:11.248363 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:04:11.251354 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:04:11.252892 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:04:11.253210 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:04:11.257857 [debug] [MainThread]: Using postgres connection "master"
15:04:11.258085 [debug] [MainThread]: On master: BEGIN
15:04:11.258259 [debug] [MainThread]: Opening a new connection, currently in state init
15:04:11.267540 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:11.267793 [debug] [MainThread]: Using postgres connection "master"
15:04:11.267964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:04:11.280584 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:04:11.282594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1f3899-cc92-4d67-8816-02249c3de546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933c4b0d0>]}
15:04:11.283015 [debug] [MainThread]: On master: ROLLBACK
15:04:11.283446 [debug] [MainThread]: Using postgres connection "master"
15:04:11.283705 [debug] [MainThread]: On master: BEGIN
15:04:11.284241 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:04:11.284459 [debug] [MainThread]: On master: COMMIT
15:04:11.284651 [debug] [MainThread]: Using postgres connection "master"
15:04:11.284827 [debug] [MainThread]: On master: COMMIT
15:04:11.285137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:11.285492 [debug] [MainThread]: On master: Close
15:04:11.286020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:04:11.286367 [info ] [MainThread]: 
15:04:11.288301 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:04:11.288544 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
15:04:11.289081 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:04:11.289281 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:04:11.289475 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:04:11.291126 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:04:11.291641 [debug] [Thread-1  ]: finished collecting timing info
15:04:11.291850 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:04:11.312837 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:04:11.314167 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:04:11.333599 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:04:11.334389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:11.345644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:04:11.361035 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:04:11.361742 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- select employee_id
-- from "dbt_training"."raw"."employees"
-- where true
      
    ) dbt_internal_test
15:04:11.362575 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 11:     ) dbt_internal_test
             ^

15:04:11.362918 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:04:11.363608 [debug] [Thread-1  ]: finished collecting timing info
15:04:11.363968 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:04:11.364555 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  syntax error at or near ")"
  LINE 11:     ) dbt_internal_test
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:04:11.364915 [error] [Thread-1  ]: 1 of 1 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.08s]
15:04:11.365514 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:04:11.393085 [debug] [MainThread]: Acquiring new postgres connection "master"
15:04:11.393531 [debug] [MainThread]: Using postgres connection "master"
15:04:11.393824 [debug] [MainThread]: On master: BEGIN
15:04:11.394429 [debug] [MainThread]: Opening a new connection, currently in state closed
15:04:11.404505 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:11.404806 [debug] [MainThread]: On master: COMMIT
15:04:11.405039 [debug] [MainThread]: Using postgres connection "master"
15:04:11.405259 [debug] [MainThread]: On master: COMMIT
15:04:11.405617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:11.405874 [debug] [MainThread]: On master: Close
15:04:11.406311 [info ] [MainThread]: 
15:04:11.406662 [info ] [MainThread]: Finished running 1 test in 0.20s.
15:04:11.406983 [debug] [MainThread]: Connection 'master' was properly closed.
15:04:11.407152 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
15:04:11.430462 [info ] [MainThread]: 
15:04:11.430930 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:04:11.431378 [info ] [MainThread]: 
15:04:11.431768 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
15:04:11.432114 [error] [MainThread]:   syntax error at or near ")"
15:04:11.432413 [error] [MainThread]:   LINE 11:     ) dbt_internal_test
15:04:11.432711 [error] [MainThread]:                ^
15:04:11.433016 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:04:11.433324 [info ] [MainThread]: 
15:04:11.433633 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
15:04:11.434035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933ac6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933f4cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933f4c710>]}


============================== 2022-05-19 15:04:29.600061 | c97ceb08-07ab-4e0f-b40d-e4a1be37d9c3 ==============================
15:04:29.600078 [info ] [MainThread]: Running with dbt=1.1.0
15:04:29.600846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:04:29.601073 [debug] [MainThread]: Tracking: tracking
15:04:29.617490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b2b4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b1b8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b1d3310>]}
15:04:29.653723 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:04:29.654307 [debug] [MainThread]: Partial parsing: deleted source source.dbt_training.staging.employees
15:04:29.654511 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/raw.yml
15:04:29.654684 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:04:29.702536 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
15:04:29.760093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c97ceb08-07ab-4e0f-b40d-e4a1be37d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b28e150>]}
15:04:29.764977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c97ceb08-07ab-4e0f-b40d-e4a1be37d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b300090>]}
15:04:29.765291 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:04:29.765611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c97ceb08-07ab-4e0f-b40d-e4a1be37d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b300a90>]}
15:04:29.766829 [info ] [MainThread]: 
15:04:29.767322 [debug] [MainThread]: Acquiring new postgres connection "master"
15:04:29.768155 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:04:29.780805 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:04:29.781149 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:04:29.781330 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:04:29.806563 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
15:04:29.806816 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:04:29.806989 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:04:29.809926 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:04:29.811341 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:04:29.811631 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:04:29.816083 [debug] [MainThread]: Using postgres connection "master"
15:04:29.816287 [debug] [MainThread]: On master: BEGIN
15:04:29.816448 [debug] [MainThread]: Opening a new connection, currently in state init
15:04:29.824545 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:29.843696 [debug] [MainThread]: Using postgres connection "master"
15:04:29.844685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:04:29.859657 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:04:29.873300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c97ceb08-07ab-4e0f-b40d-e4a1be37d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b322890>]}
15:04:29.873863 [debug] [MainThread]: On master: ROLLBACK
15:04:29.874435 [debug] [MainThread]: Using postgres connection "master"
15:04:29.874743 [debug] [MainThread]: On master: BEGIN
15:04:29.875260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:04:29.875533 [debug] [MainThread]: On master: COMMIT
15:04:29.875776 [debug] [MainThread]: Using postgres connection "master"
15:04:29.875998 [debug] [MainThread]: On master: COMMIT
15:04:29.876354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:29.876648 [debug] [MainThread]: On master: Close
15:04:29.877116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:04:29.877539 [info ] [MainThread]: 
15:04:29.879889 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:04:29.880397 [info ] [Thread-1  ]: 1 of 2 START test always_fail_test ............................................. [RUN]
15:04:29.881055 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:04:29.881301 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:04:29.881506 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:04:29.883040 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:04:29.883631 [debug] [Thread-1  ]: finished collecting timing info
15:04:29.883863 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:04:29.906637 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:04:29.907215 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:04:29.907411 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:04:29.907578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:29.917610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:04:29.917864 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:04:29.918044 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- select employee_id
-- from "dbt_training"."raw"."employees"
-- where true
      
    ) dbt_internal_test
15:04:29.918498 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 11:     ) dbt_internal_test
             ^

15:04:29.918723 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:04:29.919176 [debug] [Thread-1  ]: finished collecting timing info
15:04:29.919399 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:04:29.919782 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  syntax error at or near ")"
  LINE 11:     ) dbt_internal_test
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:04:29.920069 [error] [Thread-1  ]: 1 of 2 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.04s]
15:04:29.920554 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:04:29.920796 [debug] [Thread-1  ]: Began running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:04:29.921120 [info ] [Thread-1  ]: 2 of 2 START test source_unique_staging_employees_employee_id .................. [RUN]
15:04:29.921664 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:04:29.921859 [debug] [Thread-1  ]: Began compiling node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:04:29.922043 [debug] [Thread-1  ]: Compiling test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:04:29.934743 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:04:29.943424 [debug] [Thread-1  ]: finished collecting timing info
15:04:29.943759 [debug] [Thread-1  ]: Began executing node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:04:29.946545 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:04:29.965988 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:04:29.966234 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: BEGIN
15:04:29.966405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:04:29.974827 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:04:29.975121 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:04:29.975295 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_id as unique_field,
    count(*) as n_records

from "dbt_training"."raw"."employees"
where employee_id is not null
group by employee_id
having count(*) > 1



      
    ) dbt_internal_test
15:04:29.976774 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
15:04:29.978875 [debug] [Thread-1  ]: finished collecting timing info
15:04:29.979102 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: ROLLBACK
15:04:29.979351 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: Close
15:04:29.979737 [info ] [Thread-1  ]: 2 of 2 PASS source_unique_staging_employees_employee_id ........................ [[32mPASS[0m in 0.06s]
15:04:29.980209 [debug] [Thread-1  ]: Finished running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:04:29.982265 [debug] [MainThread]: Acquiring new postgres connection "master"
15:04:29.982506 [debug] [MainThread]: Using postgres connection "master"
15:04:29.982682 [debug] [MainThread]: On master: BEGIN
15:04:29.982843 [debug] [MainThread]: Opening a new connection, currently in state closed
15:04:29.990976 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:04:29.991240 [debug] [MainThread]: On master: COMMIT
15:04:29.991443 [debug] [MainThread]: Using postgres connection "master"
15:04:29.991620 [debug] [MainThread]: On master: COMMIT
15:04:29.991999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:04:29.992215 [debug] [MainThread]: On master: Close
15:04:29.992639 [info ] [MainThread]: 
15:04:29.992976 [info ] [MainThread]: Finished running 2 tests in 0.23s.
15:04:29.993379 [debug] [MainThread]: Connection 'master' was properly closed.
15:04:29.993573 [debug] [MainThread]: Connection 'test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc' was properly closed.
15:04:29.998455 [info ] [MainThread]: 
15:04:29.998806 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:04:29.999143 [info ] [MainThread]: 
15:04:29.999439 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
15:04:29.999730 [error] [MainThread]:   syntax error at or near ")"
15:04:30.000003 [error] [MainThread]:   LINE 11:     ) dbt_internal_test
15:04:30.000271 [error] [MainThread]:                ^
15:04:30.000537 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:04:30.000822 [info ] [MainThread]: 
15:04:30.001117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
15:04:30.001484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b1b8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b293150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97b4ae910>]}


============================== 2022-05-19 15:05:13.149685 | 9700f056-4243-4b8a-9e8e-938e5af33730 ==============================
15:05:13.149705 [info ] [MainThread]: Running with dbt=1.1.0
15:05:13.150857 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:05:13.151060 [debug] [MainThread]: Tracking: tracking
15:05:13.166932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb40ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb30c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb40e450>]}
15:05:13.219537 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
15:05:13.219824 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:05:13.259326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9700f056-4243-4b8a-9e8e-938e5af33730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb43f350>]}
15:05:13.265072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9700f056-4243-4b8a-9e8e-938e5af33730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb45d710>]}
15:05:13.265438 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:05:13.265819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9700f056-4243-4b8a-9e8e-938e5af33730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb45df90>]}
15:05:13.267273 [info ] [MainThread]: 
15:05:13.267828 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:13.268794 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:05:13.282850 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:05:13.283168 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:05:13.283379 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:05:13.322417 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
15:05:13.322661 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:05:13.322828 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:05:13.326433 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:05:13.328029 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:05:13.328354 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:05:13.333051 [debug] [MainThread]: Using postgres connection "master"
15:05:13.333277 [debug] [MainThread]: On master: BEGIN
15:05:13.333451 [debug] [MainThread]: Opening a new connection, currently in state init
15:05:13.342233 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:13.342497 [debug] [MainThread]: Using postgres connection "master"
15:05:13.342745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:05:13.352021 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:05:13.353524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9700f056-4243-4b8a-9e8e-938e5af33730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb478250>]}
15:05:13.353866 [debug] [MainThread]: On master: ROLLBACK
15:05:13.354176 [debug] [MainThread]: Using postgres connection "master"
15:05:13.354359 [debug] [MainThread]: On master: BEGIN
15:05:13.354768 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:05:13.354989 [debug] [MainThread]: On master: COMMIT
15:05:13.355177 [debug] [MainThread]: Using postgres connection "master"
15:05:13.355348 [debug] [MainThread]: On master: COMMIT
15:05:13.355621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:13.355849 [debug] [MainThread]: On master: Close
15:05:13.356235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:05:13.356557 [info ] [MainThread]: 
15:05:13.359342 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:05:13.359602 [info ] [Thread-1  ]: 1 of 2 START test always_fail_test ............................................. [RUN]
15:05:13.360128 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:05:13.360343 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:05:13.360576 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:05:13.362224 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:05:13.362832 [debug] [Thread-1  ]: finished collecting timing info
15:05:13.363058 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:05:13.384775 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:05:13.394299 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:05:13.394639 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:05:13.394881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:13.404470 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:05:13.423726 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:05:13.424858 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- select employee_id
-- from "dbt_training"."raw"."employees"
-- where true
      
    ) dbt_internal_test
15:05:13.425724 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 11:     ) dbt_internal_test
             ^

15:05:13.426091 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:05:13.426791 [debug] [Thread-1  ]: finished collecting timing info
15:05:13.427182 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:05:13.427693 [debug] [Thread-1  ]: Database Error in test always_fail_test (tests/always_fail_test.sql)
  syntax error at or near ")"
  LINE 11:     ) dbt_internal_test
               ^
  compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:05:13.428064 [error] [Thread-1  ]: 1 of 2 ERROR always_fail_test .................................................. [[31mERROR[0m in 0.07s]
15:05:13.428673 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:05:13.428991 [debug] [Thread-1  ]: Began running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:13.429404 [info ] [Thread-1  ]: 2 of 2 START test source_unique_staging_employees_employee_id .................. [RUN]
15:05:13.430100 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:13.430357 [debug] [Thread-1  ]: Began compiling node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:13.430602 [debug] [Thread-1  ]: Compiling test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:13.444377 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:13.445025 [debug] [Thread-1  ]: finished collecting timing info
15:05:13.445277 [debug] [Thread-1  ]: Began executing node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:13.447648 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:13.448373 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:13.448608 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: BEGIN
15:05:13.448795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:13.457610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:05:13.457864 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:13.458052 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_id as unique_field,
    count(*) as n_records

from "dbt_training"."raw"."employees"
where employee_id is not null
group by employee_id
having count(*) > 1



      
    ) dbt_internal_test
15:05:13.459630 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
15:05:13.461902 [debug] [Thread-1  ]: finished collecting timing info
15:05:13.462139 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: ROLLBACK
15:05:13.462431 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: Close
15:05:13.462859 [info ] [Thread-1  ]: 2 of 2 PASS source_unique_staging_employees_employee_id ........................ [[32mPASS[0m in 0.03s]
15:05:13.463360 [debug] [Thread-1  ]: Finished running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:13.568656 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:13.569028 [debug] [MainThread]: Using postgres connection "master"
15:05:13.569278 [debug] [MainThread]: On master: BEGIN
15:05:13.569503 [debug] [MainThread]: Opening a new connection, currently in state closed
15:05:13.578423 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:13.578701 [debug] [MainThread]: On master: COMMIT
15:05:13.578892 [debug] [MainThread]: Using postgres connection "master"
15:05:13.579073 [debug] [MainThread]: On master: COMMIT
15:05:13.579365 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:13.579598 [debug] [MainThread]: On master: Close
15:05:13.580018 [info ] [MainThread]: 
15:05:13.580364 [info ] [MainThread]: Finished running 2 tests in 0.31s.
15:05:13.580683 [debug] [MainThread]: Connection 'master' was properly closed.
15:05:13.580854 [debug] [MainThread]: Connection 'test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc' was properly closed.
15:05:13.587026 [info ] [MainThread]: 
15:05:13.587397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:05:13.587753 [info ] [MainThread]: 
15:05:13.588059 [error] [MainThread]: [33mDatabase Error in test always_fail_test (tests/always_fail_test.sql)[0m
15:05:13.588358 [error] [MainThread]:   syntax error at or near ")"
15:05:13.588644 [error] [MainThread]:   LINE 11:     ) dbt_internal_test
15:05:13.588927 [error] [MainThread]:                ^
15:05:13.589211 [error] [MainThread]:   compiled SQL at target/run/dbt_training/tests/always_fail_test.sql
15:05:13.589513 [info ] [MainThread]: 
15:05:13.589811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
15:05:13.590197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb685cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb68ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fb68cd90>]}


============================== 2022-05-19 15:05:48.313559 | a4bb92ac-5295-45f5-a879-b48735c7e4c5 ==============================
15:05:48.313644 [info ] [MainThread]: Running with dbt=1.1.0
15:05:48.315241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:05:48.315477 [debug] [MainThread]: Tracking: tracking
15:05:48.332055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81440fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81440f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81440f790>]}
15:05:48.385042 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:05:48.385331 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:05:48.385706 [debug] [MainThread]: Partial parsing: updated file: dbt_training://tests/always_fail_test.sql
15:05:48.456359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4bb92ac-5295-45f5-a879-b48735c7e4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8142d6ad0>]}
15:05:48.462100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4bb92ac-5295-45f5-a879-b48735c7e4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814432510>]}
15:05:48.462466 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:05:48.462817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4bb92ac-5295-45f5-a879-b48735c7e4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814432910>]}
15:05:48.464224 [info ] [MainThread]: 
15:05:48.464790 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:48.465722 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:05:48.478824 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:05:48.490211 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:05:48.491173 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:05:48.530948 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
15:05:48.531210 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:05:48.531387 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:05:48.534353 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:05:48.536005 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:05:48.536324 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:05:48.540838 [debug] [MainThread]: Using postgres connection "master"
15:05:48.541057 [debug] [MainThread]: On master: BEGIN
15:05:48.541221 [debug] [MainThread]: Opening a new connection, currently in state init
15:05:48.549999 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:48.550214 [debug] [MainThread]: Using postgres connection "master"
15:05:48.550380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:05:48.561111 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:05:48.563225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4bb92ac-5295-45f5-a879-b48735c7e4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81444f9d0>]}
15:05:48.563644 [debug] [MainThread]: On master: ROLLBACK
15:05:48.564106 [debug] [MainThread]: Using postgres connection "master"
15:05:48.564386 [debug] [MainThread]: On master: BEGIN
15:05:48.564940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:05:48.565209 [debug] [MainThread]: On master: COMMIT
15:05:48.565446 [debug] [MainThread]: Using postgres connection "master"
15:05:48.565665 [debug] [MainThread]: On master: COMMIT
15:05:48.566046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:48.566334 [debug] [MainThread]: On master: Close
15:05:48.566833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:05:48.567266 [info ] [MainThread]: 
15:05:48.569180 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:05:48.570457 [info ] [Thread-1  ]: 1 of 2 START test always_fail_test ............................................. [RUN]
15:05:48.571061 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:05:48.571648 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:05:48.571880 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:05:48.573478 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:05:48.574047 [debug] [Thread-1  ]: finished collecting timing info
15:05:48.574258 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:05:48.594964 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
15:05:48.595559 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:05:48.595747 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
15:05:48.595905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:48.604416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:05:48.604652 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
15:05:48.604816 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
15:05:48.605903 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
15:05:48.607871 [debug] [Thread-1  ]: finished collecting timing info
15:05:48.608071 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
15:05:48.608415 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
15:05:48.608801 [info ] [Thread-1  ]: 1 of 2 PASS always_fail_test ................................................... [[32mPASS[0m in 0.04s]
15:05:48.609236 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:05:48.609468 [debug] [Thread-1  ]: Began running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:48.609769 [info ] [Thread-1  ]: 2 of 2 START test source_unique_staging_employees_employee_id .................. [RUN]
15:05:48.610230 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:48.610405 [debug] [Thread-1  ]: Began compiling node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:48.610571 [debug] [Thread-1  ]: Compiling test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:48.623844 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:48.624385 [debug] [Thread-1  ]: finished collecting timing info
15:05:48.624588 [debug] [Thread-1  ]: Began executing node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:48.626620 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:48.627115 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:48.627289 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: BEGIN
15:05:48.627443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:48.636212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:05:48.636448 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"
15:05:48.636614 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_id as unique_field,
    count(*) as n_records

from "dbt_training"."raw"."employees"
where employee_id is not null
group by employee_id
having count(*) > 1



      
    ) dbt_internal_test
15:05:48.638075 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
15:05:48.639710 [debug] [Thread-1  ]: finished collecting timing info
15:05:48.639916 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: ROLLBACK
15:05:48.640244 [debug] [Thread-1  ]: On test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc: Close
15:05:48.640649 [info ] [Thread-1  ]: 2 of 2 PASS source_unique_staging_employees_employee_id ........................ [[32mPASS[0m in 0.03s]
15:05:48.641118 [debug] [Thread-1  ]: Finished running node test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc
15:05:48.669388 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:48.687630 [debug] [MainThread]: Using postgres connection "master"
15:05:48.688331 [debug] [MainThread]: On master: BEGIN
15:05:48.688629 [debug] [MainThread]: Opening a new connection, currently in state closed
15:05:48.699532 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:48.713248 [debug] [MainThread]: On master: COMMIT
15:05:48.713514 [debug] [MainThread]: Using postgres connection "master"
15:05:48.713686 [debug] [MainThread]: On master: COMMIT
15:05:48.714011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:48.714211 [debug] [MainThread]: On master: Close
15:05:48.714622 [info ] [MainThread]: 
15:05:48.714946 [info ] [MainThread]: Finished running 2 tests in 0.25s.
15:05:48.715245 [debug] [MainThread]: Connection 'master' was properly closed.
15:05:48.715401 [debug] [MainThread]: Connection 'test.dbt_training.source_unique_staging_employees_employee_id.407d46fdfc' was properly closed.
15:05:48.737479 [info ] [MainThread]: 
15:05:48.737875 [info ] [MainThread]: [32mCompleted successfully[0m
15:05:48.738271 [info ] [MainThread]: 
15:05:48.738586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:05:48.738981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8147aefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814442910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814442890>]}


============================== 2022-05-19 15:07:50.414770 | 559b6a34-5657-4463-9c74-dd5018909baf ==============================
15:07:50.414789 [info ] [MainThread]: Running with dbt=1.1.0
15:07:50.415970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
15:07:50.416166 [debug] [MainThread]: Tracking: tracking
15:07:50.432615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bcde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bc2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bc21d0>]}
15:07:50.484973 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:07:50.485583 [debug] [MainThread]: Partial parsing: deleted source source.dbt_training.staging.employees
15:07:50.485826 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/raw.yml
15:07:50.486012 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:07:50.535376 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
15:07:50.578628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '559b6a34-5657-4463-9c74-dd5018909baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bff790>]}
15:07:50.583651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '559b6a34-5657-4463-9c74-dd5018909baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5c66d90>]}
15:07:50.583965 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:07:50.584295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '559b6a34-5657-4463-9c74-dd5018909baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5baeed0>]}
15:07:50.585605 [info ] [MainThread]: 
15:07:50.586112 [debug] [MainThread]: Acquiring new postgres connection "master"
15:07:50.586832 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:07:50.599122 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:07:50.599377 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:07:50.599553 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:07:50.645596 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
15:07:50.645867 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:07:50.646053 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:07:50.648989 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:07:50.650694 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:07:50.651017 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:07:50.655738 [debug] [MainThread]: Using postgres connection "master"
15:07:50.655934 [debug] [MainThread]: On master: BEGIN
15:07:50.656100 [debug] [MainThread]: Opening a new connection, currently in state init
15:07:50.664915 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:07:50.687671 [debug] [MainThread]: Using postgres connection "master"
15:07:50.688309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:07:50.700602 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:07:50.714516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '559b6a34-5657-4463-9c74-dd5018909baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5c1c510>]}
15:07:50.714972 [debug] [MainThread]: On master: ROLLBACK
15:07:50.715429 [debug] [MainThread]: On master: Close
15:07:50.715986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:07:50.716355 [info ] [MainThread]: 
15:07:50.718808 [debug] [Thread-1  ]: Began running node model.dbt_training.employee_names
15:07:50.719291 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.employee_names"
15:07:50.719517 [debug] [Thread-1  ]: Began compiling node model.dbt_training.employee_names
15:07:50.719722 [debug] [Thread-1  ]: Compiling model.dbt_training.employee_names
15:07:50.732266 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.employee_names"
15:07:50.733246 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.733497 [debug] [Thread-1  ]: Began executing node model.dbt_training.employee_names
15:07:50.733717 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.734220 [debug] [Thread-1  ]: Finished running node model.dbt_training.employee_names
15:07:50.734490 [debug] [Thread-1  ]: Began running node model.dbt_training.hoge
15:07:50.734958 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_training.hoge"
15:07:50.735185 [debug] [Thread-1  ]: Began compiling node model.dbt_training.hoge
15:07:50.735384 [debug] [Thread-1  ]: Compiling model.dbt_training.hoge
15:07:50.738339 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_training.hoge"
15:07:50.739226 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.739456 [debug] [Thread-1  ]: Began executing node model.dbt_training.hoge
15:07:50.739662 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.740159 [debug] [Thread-1  ]: Finished running node model.dbt_training.hoge
15:07:50.740415 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
15:07:50.740779 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
15:07:50.740988 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
15:07:50.741182 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
15:07:50.742652 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
15:07:50.743622 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.743852 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
15:07:50.744057 [debug] [Thread-1  ]: finished collecting timing info
15:07:50.744530 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
15:07:50.821461 [debug] [MainThread]: Connection 'master' was properly closed.
15:07:50.829972 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
15:07:50.837568 [info ] [MainThread]: Done.
15:07:50.846393 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
15:07:50.846683 [info ] [MainThread]: Building catalog
15:07:50.848692 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_training.information_schema"
15:07:50.858215 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
15:07:50.858507 [debug] [ThreadPool]: On dbt_training.information_schema: BEGIN
15:07:50.858733 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:07:50.869591 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:07:50.877070 [debug] [ThreadPool]: Using postgres connection "dbt_training.information_schema"
15:07:50.877357 [debug] [ThreadPool]: On dbt_training.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "dbt_training.information_schema"} */

    
    

    select
        'dbt_training' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('raw') or upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
15:07:50.883335 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.01 seconds
15:07:50.892436 [debug] [ThreadPool]: On dbt_training.information_schema: ROLLBACK
15:07:50.906869 [debug] [ThreadPool]: On dbt_training.information_schema: Close
15:07:50.916235 [info ] [MainThread]: Catalog written to /Users/haratodaisuke/Dropbox/working/dbt/dbt_training/target/catalog.json
15:07:50.916747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bff790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c5bffc50>]}
15:07:51.828607 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
15:07:51.828857 [debug] [MainThread]: Connection 'dbt_training.information_schema' was properly closed.


============================== 2022-05-19 15:07:59.942831 | af3c73f5-8d56-4ece-821c-8b15ec84439f ==============================
15:07:59.942852 [info ] [MainThread]: Running with dbt=1.1.0
15:07:59.943938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
15:07:59.944117 [debug] [MainThread]: Tracking: tracking
15:07:59.960536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bef1fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bef1fb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bef1fb510>]}
15:07:59.964616 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
15:07:59.965055 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
15:07:59.965353 [info ] [MainThread]: 
15:07:59.965624 [info ] [MainThread]: 
15:07:59.965893 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-19 15:14:43.940223 | 79344c12-925a-48ce-ab7f-bc3d5c7eb186 ==============================
15:14:43.940251 [info ] [MainThread]: Running with dbt=1.1.0
15:14:43.941377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
15:14:43.941636 [debug] [MainThread]: Tracking: tracking
15:14:43.960508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c1f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c39490>]}
15:14:44.009977 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
15:14:44.010618 [debug] [MainThread]: Partial parsing: deleted source source.dbt_training.staging.employees
15:14:44.010849 [debug] [MainThread]: Partial parsing: update schema file: dbt_training://models/raw.yml
15:14:44.011037 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
15:14:44.078377 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
15:14:44.132577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79344c12-925a-48ce-ab7f-bc3d5c7eb186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4bd1bd0>]}
15:14:44.138415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79344c12-925a-48ce-ab7f-bc3d5c7eb186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c1ff10>]}
15:14:44.138797 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:14:44.139164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79344c12-925a-48ce-ab7f-bc3d5c7eb186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c18c10>]}
15:14:44.141531 [info ] [MainThread]: 
15:14:44.142613 [debug] [MainThread]: Acquiring new postgres connection "master"
15:14:44.143474 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
15:14:44.187571 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:14:44.187860 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
15:14:44.188077 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:14:44.311335 [debug] [ThreadPool]: SQL status: BEGIN in 0.12 seconds
15:14:44.311589 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
15:14:44.311737 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:14:44.314378 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:14:44.315708 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
15:14:44.315989 [debug] [ThreadPool]: On list_dbt_training_public: Close
15:14:44.320212 [debug] [MainThread]: Using postgres connection "master"
15:14:44.320414 [debug] [MainThread]: On master: BEGIN
15:14:44.320568 [debug] [MainThread]: Opening a new connection, currently in state init
15:14:44.328765 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:14:44.329034 [debug] [MainThread]: Using postgres connection "master"
15:14:44.329231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:14:44.339471 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:14:44.340859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79344c12-925a-48ce-ab7f-bc3d5c7eb186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4c391d0>]}
15:14:44.341185 [debug] [MainThread]: On master: ROLLBACK
15:14:44.341500 [debug] [MainThread]: On master: Close
15:14:44.341916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:14:44.342261 [info ] [MainThread]: 
15:14:44.344353 [debug] [Thread-1  ]: Began running node source.dbt_training.staging.employees
15:14:44.344621 [info ] [Thread-1  ]: 1 of 1 START freshness of staging.employees .................................... [RUN]
15:14:44.345180 [debug] [Thread-1  ]: Acquiring new postgres connection "source.dbt_training.staging.employees"
15:14:44.345389 [debug] [Thread-1  ]: Began compiling node source.dbt_training.staging.employees
15:14:44.345601 [debug] [Thread-1  ]: finished collecting timing info
15:14:44.345793 [debug] [Thread-1  ]: Began executing node source.dbt_training.staging.employees
15:14:44.346249 [debug] [Thread-1  ]: Acquiring new postgres connection "source.dbt_training.staging.employees"
15:14:44.346475 [debug] [Thread-1  ]: Using postgres connection "source.dbt_training.staging.employees"
15:14:44.346661 [debug] [Thread-1  ]: On source.dbt_training.staging.employees: BEGIN
15:14:44.346832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:14:44.355711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:14:44.355991 [debug] [Thread-1  ]: On source.dbt_training.staging.employees: COMMIT
15:14:44.356183 [debug] [Thread-1  ]: Using postgres connection "source.dbt_training.staging.employees"
15:14:44.356367 [debug] [Thread-1  ]: On source.dbt_training.staging.employees: COMMIT
15:14:44.356645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:14:44.368309 [debug] [Thread-1  ]: Using postgres connection "source.dbt_training.staging.employees"
15:14:44.368558 [debug] [Thread-1  ]: On source.dbt_training.staging.employees: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "source.dbt_training.staging.employees"} */
select
      max(loaded_at) as max_loaded_at,
      now() as snapshotted_at
    from "dbt_training"."raw"."employees"
    
  
15:14:44.374566 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
15:14:44.376914 [debug] [Thread-1  ]: On source.dbt_training.staging.employees: Close
15:14:44.377472 [debug] [Thread-1  ]: finished collecting timing info
15:14:44.377892 [error] [Thread-1  ]: 1 of 1 ERROR STALE freshness of staging.employees .............................. [[31mERROR STALE[0m in 0.03s]
15:14:44.378445 [debug] [Thread-1  ]: Finished running node source.dbt_training.staging.employees
15:14:44.445573 [debug] [MainThread]: Connection 'master' was properly closed.
15:14:44.445860 [debug] [MainThread]: Connection 'source.dbt_training.staging.employees' was properly closed.
15:14:44.451141 [info ] [MainThread]: 
15:14:44.451535 [info ] [MainThread]: Done.
15:14:44.451930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4ca94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4ca9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c4ca9410>]}


============================== 2022-05-19 21:45:27.480094 | 149a742c-093c-4cea-a479-2c63749a91e0 ==============================
21:45:27.480124 [info ] [MainThread]: Running with dbt=1.1.0
21:45:27.481280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
21:45:27.481465 [debug] [MainThread]: Tracking: tracking
21:45:27.504307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a3c70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a3e1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a3e1510>]}
21:45:27.558876 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
21:45:27.559305 [debug] [MainThread]: Partial parsing: added file: dbt_training://seeds/jobs_jp.csv
21:45:27.559492 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
21:45:27.631719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '149a742c-093c-4cea-a479-2c63749a91e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3455d5210>]}
21:45:27.638174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '149a742c-093c-4cea-a479-2c63749a91e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a51e790>]}
21:45:27.638513 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:45:27.638876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149a742c-093c-4cea-a479-2c63749a91e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a3e7550>]}
21:45:27.640228 [info ] [MainThread]: 
21:45:27.640765 [debug] [MainThread]: Acquiring new postgres connection "master"
21:45:27.641526 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training"
21:45:27.654066 [debug] [ThreadPool]: Using postgres connection "list_dbt_training"
21:45:27.654321 [debug] [ThreadPool]: On list_dbt_training: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training"} */

    select distinct nspname from pg_namespace
  
21:45:27.654508 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:45:27.701552 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
21:45:27.702987 [debug] [ThreadPool]: On list_dbt_training: Close
21:45:27.704108 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
21:45:27.710690 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
21:45:27.710885 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
21:45:27.711041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:45:27.719209 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:45:27.719441 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
21:45:27.719619 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:45:27.722712 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
21:45:27.723965 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
21:45:27.724266 [debug] [ThreadPool]: On list_dbt_training_public: Close
21:45:27.728793 [debug] [MainThread]: Using postgres connection "master"
21:45:27.728985 [debug] [MainThread]: On master: BEGIN
21:45:27.729145 [debug] [MainThread]: Opening a new connection, currently in state init
21:45:27.737137 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:45:27.737368 [debug] [MainThread]: Using postgres connection "master"
21:45:27.737539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:45:27.747151 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:45:27.764080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149a742c-093c-4cea-a479-2c63749a91e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a51e1d0>]}
21:45:27.764618 [debug] [MainThread]: On master: ROLLBACK
21:45:27.765184 [debug] [MainThread]: Using postgres connection "master"
21:45:27.765510 [debug] [MainThread]: On master: BEGIN
21:45:27.766075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:45:27.766353 [debug] [MainThread]: On master: COMMIT
21:45:27.766599 [debug] [MainThread]: Using postgres connection "master"
21:45:27.766776 [debug] [MainThread]: On master: COMMIT
21:45:27.767058 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:45:27.767265 [debug] [MainThread]: On master: Close
21:45:27.767646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:45:27.767986 [info ] [MainThread]: 
21:45:27.770079 [debug] [Thread-1  ]: Began running node seed.dbt_training.jobs_jp
21:45:27.789224 [info ] [Thread-1  ]: 1 of 1 START seed file public.jobs_jp .......................................... [RUN]
21:45:27.791031 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dbt_training.jobs_jp"
21:45:27.791369 [debug] [Thread-1  ]: Began compiling node seed.dbt_training.jobs_jp
21:45:27.791695 [debug] [Thread-1  ]: finished collecting timing info
21:45:27.792004 [debug] [Thread-1  ]: Began executing node seed.dbt_training.jobs_jp
21:45:27.834465 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_training.jobs_jp"
21:45:27.834671 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: BEGIN
21:45:27.834897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:45:27.842862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
21:45:27.843071 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_training.jobs_jp"
21:45:27.843236 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "seed.dbt_training.jobs_jp"} */

    create table "dbt_training"."public"."jobs_jp" ("job_id" integer," job_titile_jp" text)
  
21:45:27.851360 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
21:45:27.875014 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_training.jobs_jp"
21:45:27.875272 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: 
          insert into "dbt_training"."public"."jobs_jp" ("job_id", " job_titile_jp") values
          (%s,%s),(%s,%s)
      ...
21:45:27.876084 [debug] [Thread-1  ]: SQL status: INSERT 0 2 in 0.0 seconds
21:45:27.880607 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_training.jobs_jp"
21:45:27.893170 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: COMMIT
21:45:27.893392 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_training.jobs_jp"
21:45:27.893556 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: COMMIT
21:45:27.894180 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
21:45:27.894663 [debug] [Thread-1  ]: finished collecting timing info
21:45:27.894874 [debug] [Thread-1  ]: On seed.dbt_training.jobs_jp: Close
21:45:27.895286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '149a742c-093c-4cea-a479-2c63749a91e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a2c8f10>]}
21:45:27.895573 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.jobs_jp ...................................... [[32mINSERT 2[0m in 0.10s]
21:45:27.896006 [debug] [Thread-1  ]: Finished running node seed.dbt_training.jobs_jp
21:45:27.979988 [debug] [MainThread]: Acquiring new postgres connection "master"
21:45:27.985281 [debug] [MainThread]: Using postgres connection "master"
21:45:27.985630 [debug] [MainThread]: On master: BEGIN
21:45:27.985862 [debug] [MainThread]: Opening a new connection, currently in state closed
21:45:27.995244 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:45:27.995526 [debug] [MainThread]: On master: COMMIT
21:45:27.995723 [debug] [MainThread]: Using postgres connection "master"
21:45:27.995906 [debug] [MainThread]: On master: COMMIT
21:45:27.996174 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:45:27.996385 [debug] [MainThread]: On master: Close
21:45:27.996796 [info ] [MainThread]: 
21:45:27.997142 [info ] [MainThread]: Finished running 1 seed in 0.36s.
21:45:27.997466 [debug] [MainThread]: Connection 'master' was properly closed.
21:45:27.997639 [debug] [MainThread]: Connection 'seed.dbt_training.jobs_jp' was properly closed.
21:45:28.003621 [info ] [MainThread]: 
21:45:28.004047 [info ] [MainThread]: [32mCompleted successfully[0m
21:45:28.004452 [info ] [MainThread]: 
21:45:28.004774 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:45:28.005173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a2c8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a2b4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a2b4390>]}


============================== 2022-05-19 21:49:47.648991 | 9863b7d7-a27f-4629-9896-2739a943643f ==============================
21:49:47.649025 [info ] [MainThread]: Running with dbt=1.1.0
21:49:47.650386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
21:49:47.650614 [debug] [MainThread]: Tracking: tracking
21:49:47.672540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8d02a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8ae3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8d02110>]}
21:49:47.731362 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
21:49:47.731669 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
21:49:47.732054 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models/hoge.sql
21:49:47.777951 [debug] [MainThread]: 1699: static parser successfully parsed hoge.sql
21:49:47.806190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9863b7d7-a27f-4629-9896-2739a943643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a35e5190>]}
21:49:47.812223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9863b7d7-a27f-4629-9896-2739a943643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8d5d650>]}
21:49:47.812601 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:49:47.812976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9863b7d7-a27f-4629-9896-2739a943643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8abd290>]}
21:49:47.814296 [info ] [MainThread]: 
21:49:47.814828 [debug] [MainThread]: Acquiring new postgres connection "master"
21:49:47.815791 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_training_public"
21:49:47.828785 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
21:49:47.829028 [debug] [ThreadPool]: On list_dbt_training_public: BEGIN
21:49:47.829196 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:49:47.885978 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
21:49:47.886218 [debug] [ThreadPool]: Using postgres connection "list_dbt_training_public"
21:49:47.886385 [debug] [ThreadPool]: On list_dbt_training_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "list_dbt_training_public"} */
select
      'dbt_training' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_training' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:49:47.889227 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
21:49:47.890815 [debug] [ThreadPool]: On list_dbt_training_public: ROLLBACK
21:49:47.891082 [debug] [ThreadPool]: On list_dbt_training_public: Close
21:49:47.895588 [debug] [MainThread]: Using postgres connection "master"
21:49:47.895787 [debug] [MainThread]: On master: BEGIN
21:49:47.895948 [debug] [MainThread]: Opening a new connection, currently in state init
21:49:47.903786 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:49:47.903986 [debug] [MainThread]: Using postgres connection "master"
21:49:47.904149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:49:47.913550 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:49:47.914730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9863b7d7-a27f-4629-9896-2739a943643f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8d6ca90>]}
21:49:47.915017 [debug] [MainThread]: On master: ROLLBACK
21:49:47.915279 [debug] [MainThread]: Using postgres connection "master"
21:49:47.915445 [debug] [MainThread]: On master: BEGIN
21:49:47.915793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:49:47.915981 [debug] [MainThread]: On master: COMMIT
21:49:47.916146 [debug] [MainThread]: Using postgres connection "master"
21:49:47.916299 [debug] [MainThread]: On master: COMMIT
21:49:47.916555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:49:47.916756 [debug] [MainThread]: On master: Close
21:49:47.917108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:49:47.917411 [info ] [MainThread]: 
21:49:47.919432 [debug] [Thread-1  ]: Began running node test.dbt_training.always_fail_test
21:49:47.919655 [info ] [Thread-1  ]: 1 of 1 START test always_fail_test ............................................. [RUN]
21:49:47.920172 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dbt_training.always_fail_test"
21:49:47.920355 [debug] [Thread-1  ]: Began compiling node test.dbt_training.always_fail_test
21:49:47.920529 [debug] [Thread-1  ]: Compiling test.dbt_training.always_fail_test
21:49:47.921998 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_training.always_fail_test"
21:49:47.923644 [debug] [Thread-1  ]: finished collecting timing info
21:49:47.923859 [debug] [Thread-1  ]: Began executing node test.dbt_training.always_fail_test
21:49:47.944687 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_training.always_fail_test"
21:49:47.946704 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
21:49:47.946974 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: BEGIN
21:49:47.947145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:49:47.966250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
21:49:47.969567 [debug] [Thread-1  ]: Using postgres connection "test.dbt_training.always_fail_test"
21:49:47.969812 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbt_training_dw", "target_name": "dev", "node_id": "test.dbt_training.always_fail_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select employee_id
from "dbt_training"."raw"."employees"
where false
      
    ) dbt_internal_test
21:49:47.971488 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
21:49:47.973633 [debug] [Thread-1  ]: finished collecting timing info
21:49:47.973859 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: ROLLBACK
21:49:47.974180 [debug] [Thread-1  ]: On test.dbt_training.always_fail_test: Close
21:49:47.974634 [info ] [Thread-1  ]: 1 of 1 PASS always_fail_test ................................................... [[32mPASS[0m in 0.05s]
21:49:47.975126 [debug] [Thread-1  ]: Finished running node test.dbt_training.always_fail_test
21:49:48.022993 [debug] [MainThread]: Acquiring new postgres connection "master"
21:49:48.023298 [debug] [MainThread]: Using postgres connection "master"
21:49:48.023488 [debug] [MainThread]: On master: BEGIN
21:49:48.023661 [debug] [MainThread]: Opening a new connection, currently in state closed
21:49:48.032589 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:49:48.032865 [debug] [MainThread]: On master: COMMIT
21:49:48.033049 [debug] [MainThread]: Using postgres connection "master"
21:49:48.033220 [debug] [MainThread]: On master: COMMIT
21:49:48.033491 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:49:48.033692 [debug] [MainThread]: On master: Close
21:49:48.034083 [info ] [MainThread]: 
21:49:48.034417 [info ] [MainThread]: Finished running 1 test in 0.22s.
21:49:48.034720 [debug] [MainThread]: Connection 'master' was properly closed.
21:49:48.034882 [debug] [MainThread]: Connection 'test.dbt_training.always_fail_test' was properly closed.
21:49:48.040965 [info ] [MainThread]: 
21:49:48.041345 [info ] [MainThread]: [32mCompleted successfully[0m
21:49:48.041701 [info ] [MainThread]: 
21:49:48.042015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:49:48.042403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8df4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8af2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a8af2f10>]}


============================== 2022-05-19 21:52:26.364358 | af90d124-5013-46f0-82c7-381d1156f863 ==============================
21:52:26.364382 [info ] [MainThread]: Running with dbt=1.1.0
21:52:26.365734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/haratodaisuke/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
21:52:26.366021 [debug] [MainThread]: Tracking: tracking
21:52:26.385335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa828439fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8284393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa828439490>]}
21:52:26.440347 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
21:52:26.440769 [debug] [MainThread]: Partial parsing: added file: dbt_training://snapshots/hoge_snapshot.sql
21:52:26.440966 [debug] [MainThread]: Partial parsing: deleted file: dbt_training://models/hoge.md
21:52:26.506524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa827d87290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8234b2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8283135d0>]}
